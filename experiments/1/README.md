Experiment with all nodes in phylogenetic tree.

IMPORTANT: This experiment can only be executed on the hqst/decimalSimple branch. The size of the 
problem will cause float precision problems resulting in very small values becoming 0. On hqst/decimalSimple
this is taken care of with the decimal library, which will make computation considerably slower.

Setup:
    Sample abundance counts are made relative to the sample.
    Data is discretized with the maxent discretization.


Questions:
    We can only mine pairs, as sample space is 2**354.
        How 'heavy' is it to mine e.g. triplets?

    Can we even do this? I.e. can we make the BIC score converge.
    What is the summary?        
        Only stuff in same lineage?
        Do we get any of the Faust results?
        Can we query the Faust results?
        Does this make sense biologically? 
            - Talk to bio about this.
        Do the patterns overlap?
            Build grap to easily visualize this.


Report:
    Write about results based on above questions.
    Create scatter plots for summary, with discretization lines. We can do this because of only mining pairs
        Put representative plot.


1 attempt:
./main.py -f ../experiments/1/Stool_maxent_discretized_all_nodes.dat -m 2 -k 20 -o ../experiments/1/summary.dat --debug
notes:
    with -k 1 -m2 -s 0.05 running time is ~7 secs. These looks almost linear in k, ie 7*k for some small k
    with -k1 -m 3 -s 0.05 running time is 1 min to find first itemset

After data cleaning with removing discrete abundances that only occur below 0.05 times:
    we only have 201 nodes/attributes
    We can mine pairs at about 2 secs per results, ie time does not go much up as the
    summary size increases.


201 items in 354 transactions

Model predictions:
query [70, 125] with fr 0.251412 query 0.247602
query [125, 126] with fr 0.251412 query 0.249664
query [29, 72] with fr 0.197740 query 0.197740
query [11, 108] with fr 0.192090 query 0.192084
query [65, 170] with fr 0.223164 query 0.223233
query [2, 190] with fr 0.194915 query 0.194915
query [85, 97] with fr 0.364407 query 0.366753
query [85, 104] with fr 0.364407 query 0.364407
query [127, 186] with fr 0.158192 query 0.158155
query [103, 149] with fr 0.155367 query 0.152935
query [12, 195] with fr 0.152542 query 0.152542
query [39, 128] with fr 0.152542 query 0.151698
query [19, 124] with fr 0.389831 query 0.384050
query [12, 177] with fr 0.152542 query 0.153815
query [24, 141] with fr 0.403955 query 0.403482
query [98, 147] with fr 0.409605 query 0.406639
query [39, 195] with fr 0.152542 query 0.155108
query [87, 163] with fr 0.138418 query 0.135999
query [6, 8] with fr 0.285311 query 0.285329
query [22, 90] with fr 0.440678 query 0.430739
query [101, 107] with fr 0.440678 query 0.438368
query [22, 101] with fr 0.440678 query 0.434957
query [9, 71] with fr 0.115819 query 0.117678
query [31, 55] with fr 0.115819 query 0.115819
query [26, 86] with fr 0.115819 query 0.115819
query [31, 194] with fr 0.115819 query 0.117874
query [9, 26] with fr 0.115819 query 0.119680
query [74, 107] with fr 0.440678 query 0.440155
query [92, 129] with fr 0.110169 query 0.110169
query [145, 153] with fr 0.129944 query 0.129944
query [28, 49] with fr 0.500000 query 0.494623
query [113, 165] with fr 0.500000 query 0.498246
query [59, 137] with fr 0.500000 query 0.503168
query [34, 102] with fr 0.500000 query 0.499092
query [13, 167] with fr 0.500000 query 0.495628
query [56, 98] with fr 0.372881 query 0.366984
query [16, 59] with fr 0.500000 query 0.500180
query [127, 150] with fr 0.135593 query 0.135593
query [197, 198] with fr 0.497175 query 0.501405
query [30, 139] with fr 0.497175 query 0.497175
query [62, 131] with fr 0.093220 query 0.093220
query [25, 33] with fr 0.090395 query 0.088043
query [82, 181] with fr 0.494350 query 0.497685
query [10, 87] with fr 0.118644 query 0.118643
query [113, 192] with fr 0.494350 query 0.489026
query [60, 174] with fr 0.491525 query 0.491525
query [68, 178] with fr 0.491525 query 0.491525
query [15, 166] with fr 0.118644 query 0.118292
query [111, 197] with fr 0.491525 query 0.503208
query [48, 191] with fr 0.488701 query 0.490069
query [70, 108] with fr 0.194915 query 0.196894
query [19, 136] with fr 0.319209 query 0.317208
query [41, 123] with fr 0.073446 query 0.073446
query [24, 45] with fr 0.330508 query 0.329410
query [84, 144] with fr 0.480226 query 0.481159
query [10, 58] with fr 0.093220 query 0.094115
query [93, 154] with fr 0.064972 query 0.064972
query [56, 172] with fr 0.279661 query 0.278442
query [67, 79] with fr 0.169492 query 0.169494
query [109, 181] with fr 0.474576 query 0.476021
query [183, 187] with fr 0.059322 query 0.059168
query [100, 161] with fr 0.059322 query 0.057912
query [88, 110] with fr 0.059322 query 0.057769
query [152, 183] with fr 0.059322 query 0.058224
query [88, 152] with fr 0.059322 query 0.058696
query [103, 140] with fr 0.104520 query 0.105412
query [83, 185] with fr 0.053672 query 0.053192
query [83, 100] with fr 0.053672 query 0.054664
query [189, 199] with fr 0.432203 query 0.432185
query [15, 54] with fr 0.090395 query 0.090395
query [67, 148] with fr 0.144068 query 0.144068
query [144, 191] with fr 0.454802 query 0.455681
query [82, 173] with fr 0.454802 query 0.457477
query [165, 184] with fr 0.084746 query 0.084092
query [122, 138] with fr 0.449153 query 0.449153
query [73, 193] with fr 0.443503 query 0.443788
query [47, 78] with fr 0.443503 query 0.443503
query [21, 190] with fr 0.200565 query 0.202919
query [1, 168] with fr 0.070621 query 0.070878
query [103, 164] with fr 0.076271 query 0.075618
query [184, 197] with fr 0.432203 query 0.448467
query [63, 141] with fr 0.217514 query 0.215397
query [8, 176] with fr 0.146893 query 0.146893
query [13, 52] with fr 0.429379 query 0.428008
query [36, 49] with fr 0.101695 query 0.102738
query [143, 165] with fr 0.104520 query 0.102899
query [65, 133] with fr 0.172316 query 0.172316
query [16, 171] with fr 0.420904 query 0.427723
query [73, 121] with fr 0.296610 query 0.296610
query [34, 167] with fr 0.418079 query 0.415759
query [66, 117] with fr 0.415254 query 0.415247
query [114, 168] with fr 0.053672 query 0.053672
query [19, 40] with fr 0.175141 query 0.176300
query [113, 118] with fr 0.110169 query 0.109361
query [112, 179] with fr 0.412429 query 0.412419
query [28, 111] with fr 0.110169 query 0.110734
query [113, 116] with fr 0.115819 query 0.113930
query [25, 125] with fr 0.090395 query 0.090855
query [113, 115] with fr 0.115819 query 0.113950
query [132, 189] with fr 0.305085 query 0.305085
query [157, 179] with fr 0.403955 query 0.403955

k=100, m=2, s=0.050000

MTV run time:  4812.57143497

Summary: 
Heuristic    BIC score   p       |C|     models  Time    Itemsets
x.xxxxxx     40518.023230    (No query)      0   0   0   I+seed
0.258570     39074.001363    0.247602    1   1   2.72    [70, 125]
0.256374     37672.768919    0.249664    2   1   1.22    [125, 126]
0.253540     36523.551047    0.197740    2   2   1.36    [29, 72]
0.249014     35420.522715    0.192084    2   3   1.26    [11, 108]
0.247358     34257.680567    0.223233    2   4   1.17    [65, 170]
0.246283     33213.776123    0.194915    2   5   1.06    [2, 190]
0.245794     31143.191777    0.366753    2   6   1.04    [85, 97]
0.243293     29203.731224    0.364407    2   6   1.28    [85, 104]
0.242473     28179.520529    0.158155    2   7   1.04    [127, 186]
0.241374     27357.136266    0.152935    2   8   1.15    [103, 149]
0.240228     26457.314743    0.152542    2   9   1.55    [12, 195]
0.240228     25557.493220    0.151698    2   10      0.96    [39, 128]
0.240036     23344.647343    0.384050    2   11      1.13    [19, 124]
0.238602     22498.867796    0.153815    2   11      1.23    [12, 177]
0.236503     20167.517834    0.403482    2   12      1.24    [24, 141]
0.235029     17880.834902    0.406639    2   13      1.84    [98, 147]
0.235404     17037.223841    0.155108    4   12      1.29    [39, 195]
0.233750     16112.973721    0.135999    4   13      1.33    [87, 163]
0.233325     14850.238088    0.285329    4   14      1.33    [6, 8]
0.226349     12346.868610    0.430739    4   15      1.54    [22, 90]
0.226349     9843.499133     0.438368    4   16      1.61    [101, 107]
0.221283     7208.363911     0.434957    4   15      1.89    [22, 101]
0.220412     6820.039491     0.117678    4   16      1.69    [9, 71]
0.220412     5818.379774     0.115819    4   17      2.01    [31, 55]
0.220412     5123.387706     0.115819    4   18      1.88    [26, 86]
0.219084     4448.255094     0.117874    4   18      1.87    [31, 194]
0.217758     3772.836715     0.119680    4   17      3.12    [9, 26]
0.217083     2059.473120     0.440155    4   17      2.14    [74, 107]
0.216413     1091.493171     0.110169    4   18      2.25    [92, 129]
0.215456     729.578970      0.129944    4   19      2.40    [145, 153]
0.207519     -2122.024143    0.494623    4   20      2.32    [28, 49]
0.207519     -4973.627255    0.498246    4   21      2.42    [113, 165]
0.207519     -7825.230367    0.503168    4   22      2.26    [59, 137]
0.207519     -10676.833480   0.499092    4   23      2.24    [34, 102]
0.207519     -13528.436592   0.495628    4   24      2.12    [13, 167]
0.205672     -15219.872124   0.366984    4   24      2.49    [56, 98]
0.205034     -17962.456052   0.500180    4   24      2.43    [16, 59]
0.204614     -18593.613403   0.135593    4   24      2.58    [127, 150]
0.203064     -21282.938091   0.501405    4   25      2.58    [197, 198]
0.203064     -23914.643591   0.497175    4   26      2.36    [30, 139]
0.202515     -24481.880411   0.093220    4   27      2.52    [62, 131]
0.199890     -25033.023249   0.088043    4   28      2.56    [25, 33]
0.198656     -27517.215448   0.497685    4   29      2.64    [82, 181]
0.197651     -28083.386176   0.118643    4   29      3.86    [10, 87]
0.196228     -30776.483188   0.489026    4   29      2.59    [113, 192]
0.194294     -32918.499379   0.491525    4   30      3.04    [60, 174]
0.194294     -35438.983164   0.491525    4   31      2.80    [68, 178]
0.192967     -35995.344703   0.118292    4   32      2.92    [15, 166]
0.192951     -38268.891606   0.503208    4   32      2.84    [111, 197]
0.189978     -40791.954931   0.490069    4   33      2.80    [48, 191]
0.189960     -41267.574051   0.196894    4   32      2.56    [70, 108]
0.184701     -42848.591089   0.317208    4   32      2.80    [19, 136]
0.181944     -43126.879874   0.073446    4   33      3.07    [41, 123]
0.181085     -44426.150664   0.329410    4   33      2.90    [24, 45]
0.177306     -46378.204154   0.481159    4   34      3.01    [84, 144]
0.172150     -46756.464839   0.094115    4   34      3.08    [10, 58]
0.171337     -47287.659340   0.064972    4   35      3.17    [93, 154]
0.169732     -48508.602165   0.278442    4   35      3.24    [56, 172]
0.169425     -49019.870757   0.169494    4   36      3.01    [67, 79]
0.167229     -50900.802236   0.476021    4   36      3.05    [109, 181]
0.163545     -51371.186968   0.059168    4   37      3.37    [183, 187]
0.163545     -51644.872583   0.057912    4   38      3.12    [100, 161]
0.163545     -52016.472344   0.057769    4   39      3.38    [88, 110]
0.162786     -52375.297345   0.058224    4   39      3.02    [152, 183]
0.162026     -52703.087054   0.058696    4   38      3.06    [88, 152]
0.158198     -53135.426473   0.105412    4   38      3.34    [103, 140]
0.155102     -53509.030961   0.053192    4   39      3.37    [83, 185]
0.146391     -53784.329378   0.054664    4   38      3.29    [83, 100]
0.145764     -55103.208592   0.432185    4   39      3.51    [189, 199]
0.145540     -55522.027105   0.090395    4   39      3.56    [15, 54]
0.142248     -56100.451658   0.144068    4   39      3.43    [67, 148]
0.141160     -57595.163520   0.455681    4   38      3.77    [144, 191]
0.140678     -59291.384504   0.457477    4   38      3.69    [82, 173]
0.136126     -58272.971606   0.084092    4   38      4.15    [165, 184]
0.134400     -59771.526769   0.449153    4   39      3.84    [122, 138]
0.129317     -60926.457611   0.443788    4   40      3.86    [73, 193]
0.127203     -62148.157703   0.443503    4   41      4.57    [47, 78]
0.124020     -62917.165085   0.202919    4   41      3.55    [21, 190]
0.122074     -63161.589680   0.070878    4   42      3.86    [1, 168]
0.114224     -63560.434913   0.075618    4   42      3.87    [103, 164]
0.110440     -64608.927869   0.448467    6   41      3.94    [184, 197]
0.110284     -65661.690073   0.215397    6   41      6.96    [63, 141]
0.109967     -65947.965534   0.146893    6   41      5.28    [8, 176]
0.108244     -67034.089048   0.428008    6   41      5.04    [13, 52]
0.104807     -66490.520913   0.102738    6   41      5.45    [36, 49]
0.101086     -66146.382930   0.102899    7   41      6.18    [143, 165]
0.100262     -66643.274880   0.172316    7   41      6.53    [65, 133]
0.098557     -67781.352497   0.427723    7   41      7.34    [16, 171]
0.097757     -68627.903569   0.296610    7   41      6.79    [73, 121]
0.095361     -69743.988873   0.415759    7   40      7.51    [34, 167]
0.094023     -70922.235057   0.415247    7   41      7.43    [66, 117]
0.092252     -70889.076993   0.053672    7   41      7.42    [114, 168]
0.091989     -71657.312104   0.176300    7   41      7.25    [19, 40]
0.091712     -70619.837564   0.109361    8   41      7.95    [113, 118]
0.090964     -71712.086472   0.412419    8   42      12.86   [112, 179]
0.091136     -71094.303759   0.110734    11      41      32.81   [28, 111]
0.086656     -70800.891468   0.113930    12      41      175.97      [113, 116]
0.085914     -71102.443440   0.090855    12      40      455.28      [25, 125]
0.084254     -69939.285118   0.113950    13      40      658.87      [113, 115]
0.084000     -71120.488168   0.305085    13      40      1764.43     [132, 189]
0.082054     -71562.434786   0.403955    13      40      1419.26     [157, 179]

[TIMER] Compute p: 184.427680
[TIMER] Find best itemset: 3259.857074
[TIMER] Block weight: 4147.767539
[TIMER] Iterative scaling: 1549.786916
[TIMER] Cummulative weight: 356.630497
[TIMER] Singletons of itemsets: 3.722426
[TIMER] Compute blocks: 1.700996
[COUNTER] Independence estimates: 3784525
[COUNTER] Block queries: 23946104
[COUNTER] Total queries: 27730629
[COUNTER] Iterative scaling max iterations: 100
[COUNTER] Independent models: 42

heuristic = [0.258570,
0.256374,
0.253540,
0.249014,
0.247358,
0.246283,
0.245794,
0.243293,
0.242473,
0.241374,
0.240228,
0.240228,
0.240036,
0.238602,
0.236503,
0.235029,
0.235404,
0.233750,
0.233325,
0.226349,
0.226349,
0.221283,
0.220412,
0.220412,
0.220412,
0.219084,
0.217758,
0.217083,
0.216413,
0.215456,
0.207519,
0.207519,
0.207519,
0.207519,
0.207519,
0.205672,
0.205034,
0.204614,
0.203064,
0.203064,
0.202515,
0.199890,
0.198656,
0.197651,
0.196228,
0.194294,
0.194294,
0.192967,
0.192951,
0.189978,
0.189960,
0.184701,
0.181944,
0.181085,
0.177306,
0.172150,
0.171337,
0.169732,
0.169425,
0.167229,
0.163545,
0.163545,
0.163545,
0.162786,
0.162026,
0.158198,
0.155102,
0.146391,
0.145764,
0.145540,
0.142248,
0.141160,
0.140678,
0.136126,
0.134400,
0.129317,
0.127203,
0.124020,
0.122074,
0.114224,
0.110440,
0.110284,
0.109967,
0.108244,
0.104807,
0.101086,
0.100262,
0.098557,
0.097757,
0.095361,
0.094023,
0.092252,
0.091989,
0.091712,
0.090964,
0.091136,
0.086656,
0.085914,
0.084254,
0.084000,
0.082054]

BIC_SCORES = [39074.001363 
,37672.768919 
,36523.551047 
,35420.522715 
,34257.680567 
,33213.776123 
,31143.191777 
,29203.731224 
,28179.520529 
,27357.136266 
,26457.314743 
,25557.493220 
,23344.647343 
,22498.867796 
,20167.517834 
,17880.834902 
,17037.223841 
,16112.973721 
,14850.238088 
,12346.868610 
,9843.499133  
,7208.363911  
,6820.039491  
,5818.379774  
,5123.387706  
,4448.255094  
,3772.836715  
,2059.473120  
,1091.493171  
,729.578970   
,-2122.024143 
,-4973.627255 
,-7825.230367 
,-10676.833480
,-13528.436592
,-15219.872124
,-17962.456052
,-18593.613403
,-21282.938091
,-23914.643591
,-24481.880411
,-25033.023249
,-27517.215448
,-28083.386176
,-30776.483188
,-32918.499379
,-35438.983164
,-35995.344703
,-38268.891606
,-40791.954931
,-41267.574051
,-42848.591089
,-43126.879874
,-44426.150664
,-46378.204154
,-46756.464839
,-47287.659340
,-48508.602165
,-49019.870757
,-50900.802236
,-51371.186968
,-51644.872583
,-52016.472344
,-52375.297345
,-52703.087054
,-53135.426473
,-53509.030961
,-53784.329378
,-55103.208592
,-55522.027105
,-56100.451658
,-57595.163520
,-59291.384504
,-58272.971606
,-59771.526769
,-60926.457611
,-62148.157703
,-62917.165085
,-63161.589680
,-63560.434913
,-64608.927869
,-65661.690073
,-65947.965534
,-67034.089048
,-66490.520913
,-66146.382930
,-66643.274880
,-67781.352497
,-68627.903569
,-69743.988873
,-70922.235057
,-70889.076993
,-71657.312104
,-70619.837564
,-71712.086472
,-71094.303759
,-70800.891468
,-71102.443440
,-69939.285118
,-71120.488168
,-71562.434786]

 C = [[70, 125],
     [125, 126],
     [29, 72],
     [11, 108],
     [65, 170],
     [2, 190],
     [85, 97],
     [85, 104],
     [127, 186],
     [103, 149],
     [12, 195],
     [39, 128],
     [19, 124],
     [12, 177],
     [24, 141],
     [98, 147],
     [39, 195],
     [87, 163],
     [6, 8],
     [22, 90],
     [101, 107],
     [22, 101],
     [9, 71],
     [31, 55],
     [26, 86],
     [31, 194],
     [9, 26],
     [74, 107],
     [92, 129],
     [145, 153],
     [28, 49],
     [113, 165],
     [59, 137],
     [34, 102],
     [13, 167],
     [56, 98],
     [16, 59],
     [127, 150],
     [197, 198],
     [30, 139],
     [62, 131],
     [25, 33],
     [82, 181],
     [10, 87],
     [113, 192],
     [60, 174],
     [68, 178],
     [15, 166],
     [111, 197],
     [48, 191],
     [70, 108],
     [19, 136],
     [41, 123],
     [24, 45],
     [84, 144],
     [10, 58],
     [93, 154],
     [56, 172],
     [67, 79],
     [109, 181],
     [183, 187],
     [100, 161],
     [88, 110],
     [152, 183],
     [88, 152],
     [103, 140],
     [83, 185],
     [83, 100],
     [189, 199],
     [15, 54],
     [67, 148],
     [144, 191],
     [82, 173],
     [165, 184],
     [122, 138],
     [73, 193],
     [47, 78],
     [21, 190],
     [1, 168],
     [103, 164],
     [184, 197],
     [63, 141],
     [8, 176],
     [13, 52],
     [36, 49],
     [143, 165],
     [65, 133],
     [16, 171],
     [73, 121],
     [34, 167],
     [66, 117],
     [114, 168],
     [19, 40],
     [113, 118],
     [112, 179],
     [28, 111],
     [113, 116],
     [25, 125],
     [113, 115],
     [132, 189],
     [157, 179]]

loop_time= [2.72    
  ,1.22    
  ,1.36    
  ,1.26    
  ,1.17    
  ,1.06    
  ,1.04    
  ,1.28    
  ,1.04    
  ,1.15    
  ,1.55    
      ,0.96    
      ,1.13    
      ,1.23    
      ,1.24    
      ,1.84    
      ,1.29    
      ,1.33    
      ,1.33    
      ,1.54    
      ,1.61    
      ,1.89    
      ,1.69    
      ,2.01    
      ,1.88    
      ,1.87    
      ,3.12    
      ,2.14    
      ,2.25    
      ,2.40    
      ,2.32    
      ,2.42    
      ,2.26    
      ,2.24    
      ,2.12    
      ,2.49    
      ,2.43    
      ,2.58    
      ,2.58    
      ,2.36    
      ,2.52    
      ,2.56    
      ,2.64    
      ,3.86    
      ,2.59    
      ,3.04    
      ,2.80    
      ,2.92    
      ,2.84    
      ,2.80    
      ,2.56    
      ,2.80    
      ,3.07    
      ,2.90    
      ,3.01    
      ,3.08    
      ,3.17    
      ,3.24    
      ,3.01    
      ,3.05    
      ,3.37    
      ,3.12    
      ,3.38    
      ,3.02    
      ,3.06    
      ,3.34    
      ,3.37    
      ,3.29    
      ,3.51    
      ,3.56    
      ,3.43    
      ,3.77    
      ,3.69    
      ,4.15    
      ,3.84    
      ,3.86    
      ,4.57    
      ,3.55    
      ,3.86    
      ,3.87    
      ,3.94    
      ,6.96    
      ,5.28    
      ,5.04    
      ,5.45    
      ,6.18    
      ,6.53    
      ,7.34    
      ,6.79    
      ,7.51    
      ,7.43    
      ,7.42    
      ,7.25    
      ,7.95    
      ,12.86   
      ,32.81   
      ,175.97      
      ,455.28      
      ,658.87      
      ,1764.43     
      ,1419.26]     

max_c = [1
,2
,2
,2
,2
,2
,2
,2
,2
,2
,2
,2
,2
,2
,2
,2
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,4
,6
,6
,6
,6
,6
,7
,7
,7
,7
,7
,7
,7
,7
,8
,8
,11
,12
,12
,13
,13
,13]

independent_models = [1 
,1 
,2 
,3 
,4 
,5 
,6 
,6 
,7 
,8 
,9 
,10
,11
,11
,12
,13
,12
,13
,14
,15
,16
,15
,16
,17
,18
,18
,17
,17
,18
,19
,20
,21
,22
,23
,24
,24
,24
,24
,25
,26
,27
,28
,29
,29
,29
,30
,31
,32
,32
,33
,32
,32
,33
,33
,34
,34
,35
,35
,36
,36
,37
,38
,39
,39
,38
,38
,39
,38
,39
,39
,39
,38
,38
,38
,39
,40
,41
,41
,42
,42
,41
,41
,41
,41
,41
,41
,41
,41
,41
,40
,41
,41
,41
,41
,42
,41
,41
,40
,40
,40
,40]