#!/usr/bin/env pypy

# Do no use integer division
# from __future__ import division
from charitems import to_binary, to_chars
from random import randint
from random import sample
from math import log
from itertools import combinations
from time import time
from memoisation import memoise
from Block import Block
from time import time
from graph import Graph, Component
from model import Model
from timer import *
# Read command line arguments
import sys, getopt

float_precision = 1e-5

# Sample
D = list()

# Model
model = Model()

# Top 10 heurestics
Z = list()

#Maximum description length
k = 3

# maximum itemset length
m = 999

# support
s = 0.25


D = [21415, 405699, 921899, 761510, 330665, 50970, 306223, 5199, 381774, 103028, 745639, 502414, 581, 562356, 957547, 932979, 570599, 23175, 638694, 136764, 470066, 833478, 716342, 50282, 63152, 947408, 82343, 888639, 190586, 621982, 589862, 682409, 134334, 688306, 632724, 334408, 929026, 548801, 551132, 504552, 845351, 138961, 544142, 92379, 49554, 915311, 903555, 962526, 30498, 289818, 10800, 345909, 487053, 125766, 523631, 174254, 559138, 256349, 754332, 938511, 1002062, 606879, 340165, 874619, 881341, 867731, 164271, 86124, 137125, 690770, 202291, 234552, 733041, 801285, 205811, 1047206, 423512, 218847, 107931, 580221, 46457, 900791, 815593, 139424, 203079, 201607, 90494, 404517, 879538, 834110, 606952, 396832, 86907, 344951, 591667, 727317, 347627, 633111, 664092, 1008713, 398054, 425449, 1046759, 605223, 455833, 873611, 351676, 349668, 770365, 419096, 564896, 851994, 407543, 851913, 695336, 515435, 922762, 797134, 369942, 872349, 495114, 227718, 402448, 399326, 334229, 382707, 151194, 889540, 535077, 778197, 380056, 637648, 893416, 902114, 1029435, 648946, 962767, 482108, 193286, 986671, 327394, 231550, 278109, 866283, 912137, 284118, 664393, 9794, 539012, 275435, 165921, 810591, 388354, 461143, 49360, 414486, 396285, 251994, 1005026, 407486, 213157, 953070, 610329, 224336, 83418, 855209, 53395, 424425, 646189, 23342, 305377, 493753, 1012500, 672178, 242262, 544137, 795057, 196304, 954895, 817445, 435515, 462169, 547429, 428031, 157882, 630440, 646981, 105647, 587554, 606385, 92989, 444736, 726758, 621216, 657007, 710537, 96419, 648289, 834942, 97076, 928094, 861473, 896428, 569212, 842970, 412296, 111054, 867388, 631813, 955413, 465995, 638286, 190938, 839092, 323203, 463151, 804090, 899056, 232127, 42629, 314318, 980576, 443360, 403920, 54771, 230824, 633898, 298065, 730677, 168881, 531705, 842610, 465424, 533300, 857033, 712976, 137554, 666771, 860443, 982378, 186829, 728970, 984119, 1017068, 283739, 32464, 982841, 396024, 242038, 959384, 957026, 397664, 989927, 375417, 797588, 766105, 350704, 139760, 553706, 348380, 428792, 849648, 652317, 392422, 519685, 597542, 568168, 686904, 197964, 708405, 531034, 915145, 279481, 970868, 720768, 355165, 743891, 893418, 413868, 986389, 850115, 402686, 798065, 848994, 799325, 732902, 666437, 752729, 642324, 887869, 991404, 481895, 303809, 736986, 468877, 875064, 397081, 368902, 130331, 151841, 159918, 785485, 33594, 84210, 58995, 478375, 244604, 429863, 543589, 520734, 636488, 44047, 566576, 1029151, 300021, 37854, 592258, 40679, 454733, 71668, 948158, 838585, 881323, 1020346, 385791, 997728, 65949, 268996, 310561, 698954, 713410, 86841, 77718, 913347, 507970, 559648, 367969, 295495, 218140, 804179, 390674, 13925, 126060, 258737, 632312, 699373, 49925, 979658, 165621, 498751, 99538, 1021119, 785247, 648251, 101732, 818373, 1038389, 806440, 559233, 697884, 131173, 236622, 392914, 159646, 402393, 440803, 539285, 470393, 922636, 52422, 248780, 693249, 983750, 186401, 799724, 779860, 584779, 949554, 661548, 478192, 1047550, 855279, 102392, 861756, 699871, 998186, 284473, 28326, 629910, 490800, 838920, 793437, 176807, 539255, 398270, 883273, 727976, 579104, 694316, 708088, 223887, 780170, 306543, 470709, 232473, 414365, 250821, 608178, 15849, 820953, 369710, 289313, 932766, 75384, 119055, 961205, 857757, 782032, 435220, 345589, 553062, 838514, 887950, 573303, 72165, 701840, 637442, 244805, 982984, 519748, 931635, 413756, 13819, 267121, 118980, 925336, 953611, 332834, 890803, 862317, 582858, 330155, 50482, 167843, 683358, 432953, 337494, 748501, 495543, 888773, 637373, 802300, 551322, 321424, 602517, 756204, 65308, 70217, 510053, 670294, 71017, 729280, 739264, 531136, 328419, 916968, 692296, 92424, 432580, 1030142, 183241, 346266, 143062, 946631, 206822, 125393, 210718, 459268, 212354, 432516, 438779, 409351, 660409, 710449, 56874, 666091, 969179, 142857, 651017, 793861, 368484, 600924, 141907, 275102, 734229, 614707, 786974, 361794, 856380, 993982, 651878, 324980, 444908, 84895, 477360, 1015017, 559771, 370956, 797234, 573547, 115337, 16373, 462979, 979092, 322844, 759524, 215601, 662922, 845317, 839335, 590995, 520312, 825068, 18020, 673940, 412221, 1036449, 585065, 320702, 765172, 935029, 280180, 41451, 469606, 337040, 446778, 665019, 19057, 83010, 303019, 916678, 13754, 328689, 625386, 437820, 817271, 513601, 490143, 464166, 564788, 9503, 988320, 1025645, 183841, 582616, 518648, 685207, 783407, 79960, 432517, 992454, 380307, 46624, 303589, 83018, 307988, 903487, 533287, 721859, 606013, 415335, 512700, 232575, 829962, 952717, 978973, 276743, 420201, 865717, 579435, 895868, 233299, 122455, 212123, 185245, 656520, 1006761, 273013, 948987, 562490, 894545, 272257, 501839, 732445, 308503, 726262, 257770, 383403, 147898, 158654]

# ex
# D = [837, 375, 244, 183, 603, 769, 315, 484, 239, 199, 77, 207, 987, 560, 978, 104, 563, 829, 400, 511, 128, 760, 984, 609, 286, 980, 999, 897, 97, 63, 885, 369, 832, 178, 361, 223, 583, 214, 576, 315, 178, 790, 278, 69, 732, 803, 87, 339, 724, 296, 729, 129, 182, 408, 110, 823, 56, 83, 1006, 601, 1020, 165, 307, 659, 116, 896, 759, 492, 950, 952, 25, 956, 395, 102, 224, 173, 56, 960, 356, 883, 892, 503, 196, 701, 320, 94, 148, 251, 775, 425, 483, 715, 168, 923, 900, 443, 37, 91, 592, 792, 444, 666, 1024, 938, 578, 426, 817, 741, 409, 784, 442, 600, 953, 1019, 139, 814, 101, 649, 569, 232, 391, 473, 857, 893, 31, 398, 172, 138, 879, 886, 813, 674, 589, 579, 444, 603, 852, 837, 98, 468, 114, 209, 129, 528, 641, 485, 532, 667, 265, 6, 461, 763, 221, 857, 47, 532, 432, 879, 505, 129, 103, 242, 410, 249, 414, 667, 514, 146, 143, 148, 503, 577, 255, 686, 975, 428, 715, 927, 776, 135, 456, 786, 1002, 145, 358, 1005, 837, 260, 43, 446, 841, 425, 830, 632, 1013, 832, 294, 672, 25, 413, 854, 342, 642, 373, 881, 91, 949, 286, 476, 42, 725, 501, 620, 913, 156, 887, 429, 549, 767, 244, 105, 1022, 631, 955, 953, 931, 163, 91, 278, 508, 621, 330, 865, 106, 755, 301, 67, 548, 635, 965, 578, 16, 639, 825, 875, 340, 974, 821, 290, 374, 820, 772, 286, 672, 787, 480, 538, 912, 744, 267, 76, 162, 497, 445, 672, 941, 795, 263, 191, 514, 292, 216, 91, 322, 127, 733, 423, 815, 933, 672, 804, 290, 965, 393, 937, 410, 252, 602, 1020, 529, 383, 188, 432, 64, 971, 66, 845, 548, 726, 875, 816, 4, 404, 599, 545, 739, 102, 665, 964, 640, 97, 180, 26, 6, 341, 887, 282, 322, 151, 583, 600, 821, 403, 205, 402, 169, 170, 445, 689, 410, 937, 839, 176, 722, 662, 55, 150, 517, 15, 330, 507, 656, 99, 307, 347, 237, 755, 483, 86, 714, 181, 18, 550, 877, 597, 803, 764, 942, 735, 311, 214, 822, 492, 890, 520, 235, 215, 267, 43, 789, 621, 628, 416, 256, 729, 42, 410, 935, 287, 897, 142, 30, 147, 464, 475, 76, 929, 440, 565, 884, 514, 533, 584, 445, 486, 458, 339, 294, 309, 534, 357, 570, 383, 508, 280, 399, 214, 734, 82, 66, 115, 250, 49, 86, 878, 98, 588, 614, 145, 158, 72, 202, 984, 430, 794, 191, 485, 48, 779, 839, 807, 537, 672, 517, 1022, 524, 407, 235, 752, 767, 777, 858, 936, 789, 642, 163, 769, 980, 1008, 973, 141, 589, 290, 590, 928, 760, 500, 310, 213, 618, 172, 702, 535, 390, 998, 702, 204, 584, 73, 222, 146, 871, 513, 911, 211, 734, 144, 725, 535, 350, 560, 573, 719, 130, 120, 423, 617, 776, 312, 663, 154, 377, 381, 728, 724, 82, 982, 66, 129, 843, 879, 56, 816, 496, 16, 957, 334, 28, 191, 153, 847, 980, 445, 618, 287, 64, 627, 184, 489, 317, 247, 700, 232, 846, 522, 385, 1016, 383, 713, 825, 199, 900, 157, 783, 11, 692, 563, 1004, 811, 843, 935, 899, 596, 681, 768, 448, 4, 334, 851, 895, 143, 409, 422, 764, 800, 495, 8, 493, 802, 675, 299, 541, 244, 522, 683, 145, 1004, 895, 940, 154, 906, 582, 838, 765, 922, 307, 767, 939, 946, 54, 54, 49, 253, 836, 465, 740, 588, 928, 226, 434, 864, 446, 627, 99, 595, 299, 805, 626, 166, 980]
# 4 outs
# D = [15, 4, 6, 0, 0, 2, 4, 6, 4, 2, 0, 2, 4, 4, 6, 2, 2, 4, 0, 7, 4, 4, 4, 5, 0, 10, 0, 2, 0, 0, 6, 6, 13, 0, 0, 4, 0, 0, 7, 6, 6, 6, 3, 0, 2, 0, 0, 2, 2, 15, 0, 4, 10, 0, 0, 12, 4, 6, 0, 6, 6, 2, 6, 6, 6, 4, 14, 0, 5, 4, 4, 4, 6, 2, 1, 0, 0, 0, 0, 0, 2, 7, 2, 6, 0, 2, 0, 4, 6, 0, 3, 0, 0, 2, 2, 0, 0, 12, 4, 4, 6, 14, 2, 4, 6, 4, 0, 2, 0, 0, 2, 4, 2, 2, 4, 4, 0, 4, 2, 2, 2, 4, 4, 2, 2, 0, 2, 1, 0, 2, 5, 7, 4, 0, 0, 6, 2, 2, 2, 0, 0, 4, 2, 10, 2, 0, 4, 0, 4, 4, 0, 6, 0, 0, 0, 6, 3, 2, 2, 0, 2, 6, 0, 0, 0, 6, 0, 4, 2, 6, 2, 2, 0, 3, 2, 4, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 4, 0, 0, 0, 4, 0, 4, 4, 4, 4, 2, 0, 0, 4, 1, 2, 6, 2, 4, 6, 4, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 4, 4, 0, 0, 4, 4, 0, 0, 4, 0, 10, 0, 0, 4, 0, 0, 0, 0, 6, 4, 0, 0, 6, 4, 0, 6, 12, 0, 4, 0, 2, 0, 0, 4, 2, 6, 4, 4, 12, 4, 2, 2, 4, 4, 4, 0, 0, 2, 2, 2, 6, 4, 0, 0, 4, 4, 0, 0, 4, 8, 4, 6, 6, 0, 2, 4, 4, 0, 6, 6, 4, 0, 4, 6, 0, 0, 0, 2, 4, 0, 4, 0, 4, 0, 4, 6, 4, 0, 2, 2, 0, 4, 0, 0, 6, 8, 2, 2, 0, 0, 4, 6, 6, 2, 2, 0, 0, 2, 6, 0, 0, 2, 0, 0, 0, 0, 4, 4, 0, 9, 6, 4, 4, 6, 0, 0, 0, 6, 4, 2, 4, 2, 7, 0, 0, 6, 4, 6, 4, 4, 4, 0, 0, 0, 0, 4, 6, 6, 0, 8, 6, 4, 4, 15, 6, 6, 0, 4, 4, 4, 6, 4, 4, 2, 2, 0, 6, 6, 2, 11, 6, 0, 4, 6, 6, 4, 0, 6, 13, 0, 6, 6, 0, 10, 9, 6, 7, 0, 12, 6, 6, 6, 5, 0, 2, 2, 7, 0, 5, 0, 1, 2, 9, 2, 4, 0, 0, 6, 0, 0, 0, 0, 6, 6, 2, 2, 0, 0, 2, 2, 0, 4, 0, 0, 4, 4, 4, 0, 4, 0, 6, 4, 0, 2, 2, 2, 2, 0, 6, 2, 14, 4, 0, 0, 4, 2, 6, 0, 6, 2, 0, 6, 0, 4, 4, 0, 0, 12, 4, 6, 0, 6, 6, 6, 4, 6, 4, 4, 4, 4, 4, 4, 4, 4, 6, 4, 0, 4, 6, 4, 0, 6, 4, 4, 2, 2, 0, 4, 0, 0, 0, 0, 4, 6, 4, 2, 0, 0, 6, 0, 4, 2, 0, 4, 0, 0, 4, 0, 6, 4, 4, 0, 6, 0, 4, 6, 6, 6, 4, 0, 2, 4, 0, 0, 6, 6, 4, 0, 4, 4, 0, 2, 6, 6, 0, 2, 6, 6, 6, 4, 6, 0, 6, 0, 6, 6, 6, 4, 6, 4, 6, 9, 6, 6, 2, 2, 4, 6, 6, 0, 0, 4, 6, 4, 0, 0, 4, 0, 4, 4, 0, 2, 2, 15, 4, 0, 4, 2, 0, 0, 4, 2, 2, 0, 0, 4]

# D = [178348558249983, 184941326696532, 176146307421270, 57329258430544, 35408819060752, 52999931396114, 193737421818388, 176145233674262, 176153790087188, 52935473300114, 194012299722896, 193737419751570, 198135432675348, 194012364767252, 52999931363350, 39805791862802, 53000468398226, 57397977907220, 198135466229776, 57397977875031, 198410344171540, 198135466262548, 193737688154132, 53274809303061, 158862268530896, 158690721464474, 198135466262672, 198135466262674, 57672855814160, 57397977907216, 198136540004502, 198135466262550, 142937589563949, 35407711764496, 140892107538576, 193737419718676, 194012297658384, 193737423945744, 57397980009207, 57397980135446, 57397980004502, 198411436785846, 17884249407507, 154618888272, 88185376147538, 17746839797840, 194012297625744, 193737419898898, 193737419753618, 22527222327999, 17815559307312, 198410344169492, 198135466270874, 193737421848592, 17746843107472, 193737421946908, 193737421815828, 158553014239286, 158553013059600, 198410681812150, 198410346397846, 194012297659026, 193737419718806, 193737419882646, 193737421848598, 193737419751444, 193737421979678, 194012297658416, 198410310615061, 193737386197140, 194012297626132, 194012297658388, 194012297658390, 52999931363346, 52999931396241, 52999931398160, 176076513148944, 52931210838032, 194012297658384, 53274809305168, 154653786258, 176145233674263, 158484328153234, 615949900546838, 194012297658384, 198410344169490, 193737419718672, 193737419751444, 193737419751446, 57397977907216, 57397977907347, 52999931396112, 57397980004368, 141098300538898, 158621767139410, 198410344169488, 52999931396112, 52999931396124, 194012297658388, 198135466262804, 193737419719830, 57397977907230, 52999931396114, 193737421828180, 193737421815958, 193738493460628, 53274809286672, 193737419751570, 52999931535376, 193737419718672, 761085419815122, 52776592998420, 57397977907218, 193737419751602, 194012299756180, 194012299755668, 140892142108688, 158759208157204, 140892410544146, 176007763394706, 185216173179026, 176420111581204, 193737419718676, 176145233772562, 202533512775826, 193737421816336, 193737421848722, 193737421815825, 193599980765200, 193874858705042, 57397977907733, 194012297625623, 194012297658388, 52999931396176, 53004226363504, 35407745351766, 52862492442770, 52931214016530, 35339027972114, 35407747448848, 57397977908240, 57397977907476, 35339025842194, 52999930445978, 35407745335442, 193737421946928, 52999931396116, 52862492442640, 52999931363348, 194012566095892, 195936715604112, 193737423945750, 158484328185872, 57397977907216, 57397977907216, 57397977874710, 193737419751443, 53001005105170, 193737419849874, 198135468359696, 52999931365522, 57397980135574, 194012297658384, 52999931396112, 198135466232336, 193737688156694, 52999897972752, 52862458855444, 264381041968274, 264381041836182, 52999931363346, 52999931396114, 35339025875024, 52999931363411, 35339025842194, 176007794720788, 52862492442768, 35270306365456, 52862491361426, 52999933460496, 54100518830096, 223372214288, 140960863715344, 158553049759760, 193737419718672, 52999931412497, 52999931363344, 52862492409872, 35270308495376, 35201586888724, 140754669600912, 193806105640976, 198410344169488, 35339025842196, 35339025874960, 175939075276820, 193599979716628, 180543280185556, 193737419753684, 52999931396114, 57397980135536, 17746838749264, 189012443284, 18296594595921, 176145233674386, 193668702339094, 193668700274706, 59871879036948, 57397977907222, 57397977923604, 57397977907216, 57672855781392, 57397977907216, 176007798915092, 193737419719312, 193737419718672, 176420111581328, 739095187095570, 176008868462608, 175939075244048, 55198954618900, 52999931396116, 17746839928848, 18021719801872, 52931211886676, 1284, 175939075244048, 35201553367056, 193737426042900, 193531800289296, 176007793705018, 176420111581200, 194012297658512, 52999931363348, 35407745318928, 52999931396112, 197998027276304, 57260538953744, 202396311294134, 193531227734100, 17180197200, 128, 17214800534, 17213788180, 52999931396112, 195936447205526, 176420111616028, 52999931363344, 52999930347540, 53274809270288, 198135466229906, 35407745351824, 176145233674256, 176007760117908, 176007761166482, 194425973613526, 52999931363348, 57329258430484, 176420078059676, 176351358582804, 176145232625682, 35339024793746, 193737419720852, 176145233674260, 193737419754004, 193738493592144, 52862492409872, 176076479627474, 35201552318482, 35201586921490, 158553047666966, 158553047666900, 35407744315408, 35407745318928, 193737419751444, 176420111616020, 193737419718672, 193737419849744, 57397977874452, 53274809303064, 193599980765204, 193599980798102, 193599980797974, 57672855814224, 53274809303250, 57673392685396, 211467015389268, 85899673616, 193737419752086, 198135468359830, 193737422373812, 193737419751440, 193737688324692, 193668700241942, 17815558242320, 52776558461072, 53206089826320, 176007760117842, 246376505376788, 52999933493264, 52999933493844, 193737421848624, 52999933460500, 193737419718672, 57397977907220, 533644976061414, 52999931363348, 35201586921488, 193531260272658, 176145233674258, 264381041836560, 105776491626516, 52999933460496, 35407747448848, 57260538954070, 57260538953784, 57260538970130, 140754670649490, 17609369387024, 176145233674256, 193737688156244, 52999931363350, 176145233838102, 744592747371218, 193737419718674, 193737419751440, 176007793672208, 176145250451474, 35407745351702, 52999931373584, 52862492409872, 52864778486290, 193737419718672, 176145233674256, 193737419751440, 35201586888720, 57260538927124, 163209085076, 154619183248, 35390566449465, 40905571027766, 57329258397716, 57397977907220, 57397977874454, 35407745351696, 35407744270352, 176145233674384, 194012297658774, 198135466396308, 193737704966546, 193737419884692, 193737421848594, 391533064616951, 176145233707024, 198135465181200, 53000199810006, 52999933495572, 53001007335446, 55198954619412, 35339562745876, 52999931398164, 52862509187088, 52862492442640, 53275883044880, 52999931363408, 52999931396116, 193737421849750, 53036441266582, 52999931396112, 57397977909272, 35682625491030, 35682622210068, 53274811498516, 53004360550271, 198961528824790, 194289591638486, 158484328185872, 158415608709652, 140892158920724, 198135468341396, 198135466262678, 57672855791636, 57397977907220, 176076516327570, 193668702339218, 35407745353744, 57380796989718, 263968725111446, 193600249201298, 53004866486395, 57674986526806, 193599980765200, 52999931396244, 57672855798358, 194012297660566, 17815559309332, 17815559274512, 194288517745622, 194025185149053, 194016594692112, 52999933525046, 686868387049174, 53000468267024, 197998027292826, 176007794720793, 55198958821782, 53274828204759, 176007793675280, 195936711409980, 57672855786006, 52999931533942, 53274809436310, 53274809442645, 158346854596624, 193531226685970, 52863566299794, 1074742370761719, 35270306365456, 52999931396149, 52999931396112, 193737419718673, 176145233717394, 105776489529369, 198135468458002, 193737426010132, 193737419718800, 195936442974352, 55200045269654, 55198954653968, 200334489485456, 194012297677904, 176145233674256, 53274809450518, 52999931396246, 53274813991442, 193668702353330, 52931211886608, 176145233678864, 52862492459602, 52862492413330, 4621419918416, 158553047662612, 52999931396176, 53010668814480, 194016594724916, 57398246342740, 61796041196564, 52999931363344, 196211593545812, 57398514778128, 53274809329814, 52999931363348, 180405843365904, 193599947210898, 193531261296338, 193737419758226, 193737419751570, 52999931409040, 198410344665174, 57397977874578, 158554087862334, 54374289440788, 52999897841680, 57397977878544, 339149980536884, 52999931363474, 193737688320502, 193737419751440, 52999931363350, 52999931396114, 52999931396112, 57397977909270, 57398514778128, 194287175565364, 194012297658388, 17746839830544, 17815559309328, 475212664904220, 52999931397140, 52999931397142, 193737419718672, 198410346277590, 246308893300374, 193599980913046, 52999948141236, 52999931363574, 35408821158164, 196073852578452, 194699458838676, 52999931404436, 55199227412500, 193737419735060, 193738225068052, 194012297634324, 140823691069574, 213391190065732, 57397977915408, 53001005105172, 52999931412502, 52999933624372, 52999931363344, 52999931398166, 53008588439572, 125567967266900, 52862492410386, 52862492409874, 52862492409872, 52999931400852, 53000199833616, 194012297658384, 193737419718672, 193737419751440, 52999931363540, 52999931363350, 53001005107348, 52999931363346, 52999931396112, 123368675590736, 52999931363382, 52999931494416, 52999931363348, 52999931398226, 52999931363344, 53000468234260, 52999931363344, 57397982068752, 193737419718676, 193737419767952, 52999931396150, 52999931396116, 193737419718676, 35339025842448, 37606772775446, 193771779457296, 193737419751956, 198410346275222, 198135466262678, 57672857911318, 57397980006676, 52999933493264, 52999933460498, 52999931396116, 52999931396112, 52999931396112, 264106784848854, 196212143659990, 52999931399188, 52999931363344, 57672855814292, 57672855814164, 193737421815952, 176420113678354, 176351359107094, 175939075244054, 615949884784656, 52999931397138, 52999931363350, 57397980004502, 57397980102806, 140892142141524, 479610981966550, 176420111581200, 444447263292406, 193737419751440, 35407747448886, 39805793927574, 35339027939350, 17815559307284, 17815559274518, 194287175565332, 1077592920423414, 196422384601721, 176145837834102, 52999931363350, 193737419753490, 194012297625746, 193737419751444, 176145233707030, 176145233707158, 198135466229776, 57397994684432, 57397977907220, 140892142141462, 176076514333300, 52999948140560, 193737419849744, 17746807291988, 18257117264, 193738495557652, 194012299755540, 52931211919376, 52931211886738, 35407745319058, 196361617661823, 180853911038932, 176145233674256, 198135466229780, 140892107505810, 198135466229776, 198135466262544, 52999931363348, 52999931363346, 193737419751570, 193737419751568, 158827892032144, 143091130761300]
# Stool
# D = [204586912993508866875824356056889446769865426053592299929910605753160686099216338230270286141003969993559888830961330525256783103478618431628906323967L, 110428152173257466120272497857202226712178891103012677587447760391110824L, 497323236417024531264298133582285560918612404828138475849023425224293999119214318332077L, 273406340597876490546570015395280003754112430708817618847975988474799833839245022706629315117383840L, 883423532389192164844028969098022088384170924359264718253558766479474721L, 28948905732862260800336200012213115654448618941466374471980102246222755725349L, 129672361527531029953512745740348785969138944757576153124864291552832900356653379574990845279596993571506183956603360286533185589981438857427792569366369212854041416015447069430825L, 210624583337114373395836055367343157897036384058556506348666355757L, 994646472819573284311607817379268798297516901706719036861488989947093829417554894585897L, 1371926270998493915864246501186864421L, 9850501549098620076476100623409717263885274694227572060049861052881917080713023456087316002271626553989743868772641L, 6393341031047152089869511126616414444674678094797663986719578489216242233812542360156580653668053219694528411429811234923856680986290823671566762277L, 108051234004218350629131474483551677103715829075175031174866655641640L, 6393341031047152089869511127907529533216583291006093911387582106734674540324088260149742146123596646574432347804031034069106465731346972463453634601L, 2993155353253689178754044181040031325182542838628396L, 211447335615774976416958152339382548060300516898415903562118397988L, 102293456496754433437912178025862473506770063938846048077693453129494727729372491852101908387256162201755115138584593818609447102916803508546625798437L, 82712691407471290762416160980307398939389902457847976340670432523687643901839565234596430503107852846504426568937208741929L, 509258994083621521567111422102344540267356831449152201580621472147618100874690476963921952L, 662347093729292053246743267618772546760217905817859179540374441033336179099184204126805343052765630167740587622914601911470L, 60383398797144661635864873295812302254681830205439530113476853721504642174890998516484746438102792883116998837933638321748627200105529462632697520568341383161279847010345L, 661055968809487859789998549835641664877302931892542810725305751655239918875103380564891666866824749580925420115200328794153L, 60383398797144661635864873295812302254670739526663046854019300803929986598274381633875350839252327806350459049083146825205869640892176808893601640807715347562370475622441L, 2527495000045373989019900795863485857851949944105301031595453120555L, 6393341031140187446579348808606718060822054414658368813998156208573513814432877570306354507735608325177479622385723089640885706901127617549028753825L, 2993155353253690506867794821490892908824670973329717L, 2135987035920910112037796550922498143036876684582218860438351879981955273084157832280557484704033L, 397444631628981487398138749046400654145762820381874332451597321734669043887712482900704872660133498355324859058465554740779924491293392484209737542410542371636340473862180074154216375116697589086806758388071069452640790332199582499108L, 842498333348473955937965522721422860705563071826346247817429450784L, 1291124939043454294827959586001505937164852896414611756625954261607441177559609906371340513005301212478840154014752636960L, 4052261297735344686047273304385899561535592023674254785152009111026028136145418111718463914987406049109568248643848426935932959278641456144790388970174839079108301517146781581613L, 21040543606193494028963959531520514662201359211292695437993123612274928617188323288454666145110363655409480974044515940612102764906083622977393279670490386975345244929528965568926372316383807712253807666796363821L, 374144419156732419900372736782015352926416190604379L, 47890485875066480139372189886595446831203648352682016L, 497323236409786642263222034815423400775701932373761226248128688775873261522923127767328L, 1291124958282715132911201388872131483386338263863180618207458871072583252577642397386463706049429952864434433148024651817L, 497323236409786642263432659398760578017052378261211540378485495152068417622188831211553L, 210624583337178726236156829231556970219645949094439045844907524129L, 1516130949512411069481425281701662651618057102172961189271552970991403461734834968135938469908042163824668414156692656808494979789014381604940705861105102133888218165125411380411074760341384592117489303365088119889864401152058863L, 21040543606193494028963963882602951817157431676399283516245168550059912144220206938243633358895655891268460982731085393809482377504475877278513132517886914458573063079114573997826010799064755792680093364232585261L, 169230328010303641331690318856389386196071598838855992136870091590247882556495704709654399461323041215766122780322191001714989L, 21040543606193494028963959531520514662201359211292695437993123612274928617188323288454835375438373959050812664363372332084225168239277973090241355044276416671655940550783572188440774693147702794194618617126650221L, 843321110735525038151144761403842521126386471567327315800326045735L, 843321110735525038151144761403841385311443850259971012256875020448L, 497323266059798602913602087443986789340275028556324436749875569579640059930815972905125L, 29642774955181098201666529875565286056023548512629597123604733091185264551395488L, 843321085627133074073382288573622860803766750978222434233898107169L, 28948022309329871608171409848348586107645275609003333526897253606452953579557L, 9850501549098619803069760025035903451306119845503233602640276461117995859965996122576973444228769549278964712411429L, 1491969709229360036894930791422831579755893004024248254230287514255327664421818388403583L, 842498333348457505275357344618247610404143491584417260001026572384L, 102293456496754433437912178686918442297018662890761082704123895578732100518951830280997885237657522910804166835111269079098353796305568076313836322857L, 93035356709837681990313447409664580397539500508574588206577308273511531759808663701731484289295793172943559300865368344224998194441568565L, 11692191504620774665473738705829186636231167639584L, 122112142331323333701730592L, 19239260838083241802871135799862041779143085126066412586718145566416865441561362872256564825327902737761475362873L, 273406341107135484630184299956922144005494937463163471151901700483264515236250274887738663027474473L, 7237116005484435446330902885688158410032791489172809496112478467016939733101L, 210624583337114373395836055367342020736419075967166558075714469920L, 93035356710006994950319849832071139705535987650552761865484650982283749159366847687335971558016429002019346040316586218506245031552813421L, 822852712300354983078650253521400843896386831376923514572308780L, 102293456496754433437912178686918442297018662890761082704123895081408864109164304702083247873563487200052757253290225361884390114865372885829246715172L, 11090678776483259438313656736572608220086346177993812863460308025339778960738478517110468116443841651474800238979901336555941921069L, 28948022309539673439229863618723169081746565848494774585587724517874252841261L, 19239260838083241802870625048898248928261591440656956481267767377600206171358606308630904291931416227538665144364L, 23134322349737717735007099635340311456574291245888123082206428617627187858318938111228919160792924135185595314181181760806069289728146403691854971829147537368070427254858957513460166553721370494645672665824046725805063733288L, 994646472819573284310975120876978799075733359035207389895074730110572960853489557110845L, 28948022309329048855892749245327508622968968853931328235750779194354120196192L, 19239260838083241802870625048898278571037319617345998590508199076962228643913207688563288884599576016331580571691L, 21040543606193494028963959531520514662201359211292695437993123714568385113942756726366844170972827330917256652353729345075558030903194924135027292787782723590618860465743786666929748352252224231802521591416029480L, 19239260838083515209211224417358504720399907609684994550812623976802889528863422285713092703833376417499658716201L, 93035356709838343046282256897524370395815929809641589018962638037932554184266589425684810485845063309409576420947845590625300969463414824L, 497323236409786642263222034815423399279124389551387828728682190297937855322170573127724L, 273406340598373813782972565031858263541876336865512470047165875191419121132594088710930107380400165L, 178405961673617470035160502688999845193777442L, 210624583337114385087849154015893786966050125815327929965866586145L, 107840609420881221278266814459526353334211692230529832849208072863776L, 210624583337114373395836055368712624847176461774144985570673819681L, 429049853758163107186368799942587076079349556760505686706957035959121484865804773192477594113632480096546465980259581956542289383245442042475574391816781857L, 7237005577595542943144591514101215426166110741131005130188650171977142309024L, 994646472819573284310764496293641680212604314693427729794378629250572222485778238472484L, 275542327633797400628957800095872222783748883384019899559274467947943941478434377968258251586404398L, 2135987035920910082395021706169762739186041638238318340329392529098417379291050691060562192367909L, 273406340597876490546562778500130823665130815249064956544710130415181163969938448856000373797357101L, 210624583337126357709306770262997582747986846787385029044019593248L, 842498333348470962782478464561055519071000786195938838378227367972L, 7237005577332262239081593504589895723913563874159455245546959053850017398816L, 19239260838083241802870625048898248928261591440656956405942534592030592487730625820363671670702476295042797076520L, 28948022309329048881001156198566066370998426261344813128074680845306824425516L, 2135987035920910082423969728479092610794213045081819337077174276467833387733726756982388830175265L, 93035356709837681990313447409664580397266094167976711716030745495121828879337686464413057512439242762459284770190202130599631924958527783L, 25108408449816412780847057274521710348735465441674304094241L, 509258994083650469589420751151225541416072509308007344130215002702638179172557080400429089L, 661055968790248598951915308032771039828404682964281219284648795274405791236311345825190582017402175324980358311863653105701L, 1372896023784894551033583678062788773L, 822752278660603021255890554196659116532032464491241825150631969L, 9850501549098619803069760025035903451269934817616361666987073351061430621280265570349365312932717694761870297858080L, 14134776518227074636666391698134852736844277479071008099070412116175028280L, 2085924839766513752353023161449430311553371523389733009604020099102882705596607685939094552616L, 1496577721228336314858137119002846296608365305594408L, 49387063328685871412612060414929711746038205115926828L, 509756317320067493237153677108896842815260611673410670449584145610216266503416085480144957L, 7237005577332262217111741920469542909243951944281126341011685659489990279204L, 102293456496754433437912178688209577105802927122292362705084195154416602624381289649973781200665897930872065390574045553675539278037382641046384173225L, 102293456496754433437912178025862473526009324776929016474223989560896513694666243969724135907869256216401602883592607982040540834498941836994988867885L, 2135987035920910082395021706277391901271307081535321008701083050447743662907723785373517487931689L, 169892675104032933384937062397414499340708305394099039642032431490061260437678605377922083854711749001039010552339092413775905L, 6393341031047152089869511127907529533216583291005820502961059887800850627304133901804787476443906966754037471545742246711110845713423408742080905509L, 661055968790248598951915581439111637704895229527059608987372943318697654952190411594337896631252291193457132034850483552289L, 13153693169163633439093196478382906207249816485920L, 452312848583266388373336134273101813918845455431128823791375724676461298084L, 79271685337959091567306735656L, 7914572847139345089936080672628710081124203171238778877330713103662927096835767223575218955032580745693038720409297316029801030576787944830040846077691099416654299200771260453L, 169230328010303641331690318856389386196071598868498766981623037618682054730692430354705755170789256118869380149050154364371301L, 60383398797144661635864873295812302254670739526663046854019300803929986598274382143134344922873848489930509798319198409821192116046377155817248044586848026020841442182441L, 9850501549098619803069760534294897534891456384835623556000216173107196922515816428943333604481052088152963938976040L, 1491969709229359926466146744440462521797946129018887783256457226945230982019655788003360L, 1491969709229359926573986531109065080976614189366967635182784773148359400932097955332137L, 497323236409786642263222034815423400775701887772272200301876626402668975207495808712740L, 994646472819573284310764496293641692173533893015413771402705832992374908284179468648741L, 4489733029880535135674435141215840022518455062954276L, 822752278672575642490499347984784935558965582724344159996084264L, 60383398797144661635864873295812302254670739695893374864322942135620305454663767829449626441698532417533585590740104139244874158687514767827887192499228714132951041441833L, 11692013098647264905633757871367973588407667195940L, 9850501549098619803069760025533226687679721459771743915133894192670156283397228707312824090982599519269199809286437L, 19239260838083241802870625048898723212659107487793411327588723224462423349376130128834506763414288776630490498081L, 483067190377157293086918986366498418037365916213304374832154406431439892786195053067024220822769270267617491677377002007796202645649060289487682478712155503145523388023076L, 29400335158122939827603244648865243660261858235034257584343908505346915303458L, 19239260838083583560796372891834698184296065477535016730166482004212701046224683960184595802228013839628202803233L, 29671722867062486524625680696921892568990678703382166984700102261885818993574181L, 9850501549098619803069760534294897534891456384727783769331613625901150316996476927715632402570491166929547363550251L, 19239260838083241802870625048898248957209613750196629820063988451434736213757846291292065821026468051262867374127L, 509258994083621521567111422102344540310757766937441311956701448682087798163392132622778408L, 509756317320038545325272288785962800409801633917087158199349554518243826219478783858770080L, 110428784047007477464887801540338787937283945217062205594169076097941729L, 509258994083621973990389000040323728164791908303410479710327710980384812456841891392716972L, 11972621413036536106982878188595994466489902335459620L, 994646472819573284310764496293641684690645509902970231743621782839777824067876096245796L, 107839786668602562171823592007730659995988350621847863707743757729829L, 273406340598373813782972565031966103328544939379793807630324432591672780323173151648716627051741216L, 706003489677054374237277210551156965837838477962894381631539255276896767190098768163513022597064485447965668647542664607942580564660732588943053282660302487790848807280538615306378803951152902329909622089578202171901985L, 460688772561223309599799143187044542348256984914116263229517370635452170347194456681267169065516338136791340549606456029544338112741724175842429486826376571453637161L, 996393222498669447697966612217892L, 210624583337115869973512682213924105857238011818723170298188661044L, 509258994083621521567111422102344540264375368106231333913867000456630610768549598756241701L, 220855883097298041197923879605963463074819117237972208731294614957195361L, 4351082437154956072465106588077822995186320276916599948287758558163568435886871636458064993230197088292312082041316304542964018891767965729164050190796112702870778039878935240706976579625L, 108050411251939676556911262777572341083120343935314601469867478155296L, 1461501637330945454298924552275899560715927289896L, 169230328010303641331690318856393558047243101575590029840214151152414118210011275590951179212120609195589507231866312903561257L, 9850501549098619803069760025533226687679721459771954539717232842535171520297460559676398454286407109151779570975009L, 169230328010303641331690318856389386196071598838884941042710792814964544186082527997434339083130870869953855643424067362160685L, 1330221833937859092771148696709169184L, 28948022309329048855892746252172155391057197619134964394399630219170177286176L, 509258994113264296411864368130778712426599472519434274330312371707065536606160735313788960L, 29642774844752946028434172174196726004645427519549883797713948037207831664525868L, 7914572847139345089936080672628710081124203171238778877250017794972711203409053925242699568521095788962446508638720043651482198673155162026847386908940475565756012405398896678L, 822752278672575642668905321537705824179981701411948946961072165L, 102293456496754433437912178025862473506770063938845774671352855253004181137646079840103013137463180479763231037985045216940115271501853168794457735461L, 2993155531659650766210629835524225408343841906032673L, 7410693932044330228989921367819078489302516905203022454426245795868512998789413L, 107840609420882752288922195226222084597547409227581105085821771252013L, 2085924839766513752338888385141827820253821001665286435670179671585109888455503757220172726304L, 2085924839766513752338888384931203236916706628269271974341914689183485782752397759361439170592L, 6393341031047152089869511126616404594173128996177860916959553453312761321102879990006386899074036058360546972747696875842843636661358541493653607456L, 102293456496754433437912178025862473526009324776929016474223480301902430065907671280759969519081947343748112214474603885350985682915314297129042318381L, 822752278662099598754135936197986973509450365454777309159424032L, 497323236409786642155383070899099500703477406709680027445413991305938718541580400721960L, 19239260838083241802870626043544721755071881328754537640729199485622700086591131513819827278028499367843305818405L, 6393341031047152089869511127907529533216583291005820502961059390477614225206810172338067931969734718540906481261944860174595377941762202157770801453L, 497323236409786642155382248146820840101917652434679950401842131659266933005956145610788L, 19239260838083241802870625048898248928261591440656956380834178523894541711526848659219613618327028271338895376421L, 661055968790248598951915308032771039828404682964281329712800968506763506062378699565800436609837548749255742273490264981664L, 211447335615786949038326579216986086890678144595304813486586593447L, 210624583337114373395836082589931194403953997499440260178128797733L, 52656145834283083081988916155086183560518936182999740198983172137L, 19239260838083241802870625048898249159845769915290169980254762748921957833144916751304318627052564422261834711328L, 2993155353253689176667491219187682919014854099075105L, 11984313426113405258988812047259522819046969229050148L, 1508269868131454770783982521644732386124590754693152L, 19239260838083241802870625546221485338048233596881702861003426741101222271603874841755643129321660150159684272161L, 178405962917820317303766860769454032771809312L, 994646472819573394846545831611264839843943892702164777366940191143669494928613850152992L, 223007453357049960802221422538492417904672800L, 497323266052561486908329099333271665920737170378707207172203882429972604957932124766241L, 661055968790248598951915308032771039828404712636004086346923872564470704214012954632544800731755645424418491217661764796450L, 11090678776483259438313656736572334813745748301503266300681918322458485231222503988737752657224106075201738861694669976146580996128L, 2993155353253689260555537417243308662788674302902304L, 273406340597876490546562778389702670669146178861651554776228779116776072471640679281829414645202976L, 1330205433746748409746765028658905129L, 129672361527531029953512745740348785969138944757576153124864291552832900356653379574990845281088963280735543883177136193058913550586654491111597190100440414547955697304045563281696L, 994646472820025597267187549350617563539770549082836428433160167233045038365914964820000L, 3004847544758299318436938679288839743843817801580576L, 273406340597876490546562778389702670669146178863148132229848171719223636495711006133512487297482792L, 1330221913199720128339220044836438048L, 994646472819573284310764496293641680202373847833516777373576222447808546737633417166888L, 1461546260599413976855982132299576639647518425129L, 29642774844968626424523655942682500965315224192818255956719120809383376273932713L, 29642774844752946028434172162225565912074447060727259514384549730881750388380072L, 178427752288553786190939500220087711140872228L, 7237005577332262213973203037089628662518691973326268414203521910600400568545L, 7237889000864651406137990196106791840724441042704387854577029812872026914976L, 44601490397385764879052892292185934128611625L, 497323236409787525578914637338985631760898579978531999571652018847782589644223862735010L, 822752278660603021077506369350178494813201396642913417456910628L, 273406340597876490546562778389702670669146179629395902662814378970526512634337671799586596753899564L, 1329249565695697362940829232679026724L, 706003489677054374237277210551156965837838477962894381170850482715673457590299624976468480248807499242724466374570999144530824216469597736936309995872222334896933531292778455314142815986226301889180021401031444605304873L, 661055968790248598951915342208563614562966030956352268484344041068872084542630627792550561627045907516691688676924129476653L, 6393341031047152089869511787672373384421727948093168949730593281717444314333005007516620221537360705861255930664982608547963142822837718522062929960L, 102293456496847468794622015707852786954179728519243040765520831964720211883141201668980705319370269525150371614453892503078038362806809854883775840288L, 11090678776483259438313656736572334813745748301503266336866946209120619053367111074937113686344376593008992503791477868094426841121L, 93035356709837681990313447409664580397300269960551446277349065842420541712348577458161056268877706383727972829721502947913496879910551584L, 273406340597876490546562778389702670669146178864656402098001403274101232504350244984399974325944360L, 273406340597876490576205553234455617520332629747346634650996894197368298806676273303700460429509921L, 47890485830464988412592446923351630181979697799888928L, 107839786769036186956547010269590103429064413359462762963946479157537L, 974843240728565233134536038678564L, 2135987035920910082395021706277391901271307129425806660760109872827731561706056821914520800329761L, 2135987035920910082395021706169552114602704522356652948353004525968323155226263916588125875994656L, 19239260838083515209211222925388795491039981143538250110350103675434437136829533833192746117258535167395501834281L, 429049853758163107186368799942587076079339706258956588087153966199096448962353532205682394710176434181390940035213151520063553745389609207267017077455257641L, 1412006979354108748474554421102313931675676955925788762341700965431346915180599249952936960497614998485448932749141998289061648432939692797049686330885736275250213469140637184497483241970763777109103171197048977126981665L, 11692013098659187556224933809302609532912086417441L, 178411408100954166546222375418200744151089320L, 2568, 129672361527531029953512745740348785969138944757576153124864291552832900356653379574990845280591640044325757240913914158243490163291843706079564245415500037871667198246745228836896L, 220855883097298041197912187592864814479270888663257344843196382053072928L, 275542327633797400628957800095980062570417485995567094243861969438813859992647412072412639146999849L, 2135987036418233318804808348432774149418127921635777159498430766569851015105455146983511303061536L, 497323236409786642155383070899099512676098641296697032083417739210474256202989887488117L, 842498333348460498430888979853089010226701500356627423894706978848L, 169230328010303641331690318856389386196568922075265778779025473838394703411573629639818927348461754557886153363494080038502689L, 108682285001951019677098818310969204439019231494962113411652935876648L, 842498333348460486738920482610525570527127464249664841205181710368L, 108682285001951069052470312304153612133494907990526962025905515069472L, 497323236409786642155382248146820840100456329203309305689271988923730601469899421909024L, 2993155531681428919309906950517671319038021509775392L, 497323236417475960689348188001107028865486481491450619478075618700590465255456802218349L, 44601490439574464313493731385270572805652649L, 44601491768334677219884749852333686081061536L, 256, 273406340597876490546570015395280002931360152049722867415618195348053224192261855233415860265289005L, 2993155353275552319552190321522934550379650538479657L, 273406340597876490546562778389702670669146178861651554553232214838956791735011226769388727251435552L, 1291124939043454294828232992342105305625108688552927925706648577420213115764248861648548187417599759653247182036345233709L, 497323236409786642263222857567702059894020034034907904359696154511437214945978578833465L, 661055968790248598951915308032771039828404682964281219392488581943008350426671463895269826003785354952828278606161622204448L, 44601576838970775304088800453594263642112040L, 1508269734326983538386387356308534353965683388842017L, 497323236417023647732715333113072700747411548292248274520757302171495725841946881163556L, 11692013098657857172211027215789269900791225450784L, 273406340597876490546562778389702670669146178864656402098001413824177921997062429084029504692289568L, 976091003280395100274386153373992L, 1496577676626844630775321552282297619324653707854116L, 994646472826810289888307383090951982645620821638163404821879255658554146277098410428333L, 273406340598373813782972565031858052917292999706241743912326948273359870805056548315400320108331049L, 497323236409786642155382248146820843093611682456999812392232574771428127718323358728232L, 6393341031047152089869511126616404594173128996177860916960064204276554403568552042207624531218786251047699887576599993738988332510468359163025752377L, 6393341031047152089869511126616404594173128996177860916960064204276554403568552042207624531218786251047699884854341058351673584174905415173055119400L, 25108408449816412802614370987610320676583252004367669788709L, 7237005577332262239081593504589717317950603218640956706001414980232641380644L, 497323236409786642263432659398760516657367591980871013616537222946634075685821436530985L, 102293456496754433437912178025862473506770063938845774671352855253004181137646080055781763722389639730655772470433852491171115635943270612644328505384L, 273406340597876490546562778389918560867066721146762505191912422741265701326835641214513602708050985L, 497323236409786642155383070899099548593962880362744598426831661615883021440975073313953L, 11692013098647223368546309304773635283641113903137L, 110427942371401299271531736286931756594770317335288720504143112152220068L, 1329252081186225386636626920026603556L, 1329576599743510590822253963640504356L, 7237005577332262213973188059620670867675292666268979805190493647566539530796L, 994646472819573284310764496293641681709181991320188618392134048954675550429060333773225L, 11692191526388213275106124555835084019097687253024L, 7237005685172048882575750243136275995829917751967850424778286572655866413089L, 661055968790248598951915308032771039828404712607056947461127212900742793012805475731901000445573247873589641513017727975464L, 661055968809487859789998549835641665871949404719353984036934899355019578785848228933220561179119665512292563372939066150953L, 273406340597876490546562778389702670669146178864644709906475016348837712063225307977944341506818081L, 994646472819573284310764496293641684690645509902968901521788002137831863195328263880737L, 510253640556470042873731516470246354931805808148316730780273971105562930936040628123467817L, 661055968790248598951915308032771040823051155812802525905796286092904511519080805060591054351327453887047832733625147392049L, 100433642743655671588465736871308593960330642449070413185064L, 100433644228541513522626019888270487400956494863112914796844L, 215679573337205121350491473949847551284603968007350518458541067141164L, 4351082437154956072465106588077822995084026820419845514905299774020122259571669856202080892625487049707057718683688950240183151279404707568114746546788695611758226735997302468532515831968L, 842498333348469466204757252559665693697024304617534130436010869156L, 169230328010303641331690318856389386196568922075294726911763587756985243863081258618407355419963052736619878561733361493803689L, 497323236417023647732714510360794026675191158136825646513686142547051056393778413371561L, 7237005577332262213973188059620670867675334188185437674936820478586332512288L, 994646472819573284310764496293643212696453212106907998137789805487386295589547331487021L, 34175792574734561318320347298713044458226609472266912587815620691177783517949155763045381884805421L, 273406340597876490546562778389702882116481794636815043899368872045942914182871246021921987437987689L, 11692013109536343161569618704368590978998485057569L, 9850501549098619803069760025035903451298883723457273516287072096506535408649211051647009957709091707347017206281385L, 497323236438734664464711297002715118848169172077263232679487412639204526778888749711405L, 994646472826810289888096758507614878736576708850293479055275206403518292156076450807840L, 11692013098647265695380041461809512444699452506400L, 1330205433746752855412122801666719776L, 11692013098648635977448707984467819946193703272612L, 178405961589221076137993742025074229539176488L, 994646472819573284310764496394075309475369063363108117624859084901609891033747630522400L, 7237005577332262213973186574735007339488603137568402955370603652116250297513L, 784637716923558102933452829929127368719496865949510467680L, 178405962253852821217430348043424060800630824L, 178406047988410800932768192966560781802536992L, 34175792574734561318320347298712834656395551019817735264768711775912765419024235285368101252300840L, 7410693711188236507108543040556027530379879384278698039472226845887486657820621L, 169230328010322880592528402098192256821120497087784254611734281758573160184276753667012793791732252867022584243856901724045352L, 1496577676648622701448232880421726841028429216415776L, 822752278672575642490521223090558069642200652430084968226160677L, 44362715105933037753254626946289339254982993703336301641462337754755862510940710707086318258235508159101921223261217346974311383077L, 44362715105933037753254626946289339254982993703336301641462337754755862510940710706355745840170783738640902587813227542403110077472L, 19239260838083241802870625048898248928261591440656956380834127638792034761479944912487685613934534087344021766185L, 1329576680209613467199035917948551200L, 273406340597876490546562778389702670669146178863148132229869949874432363552357762703788288407961632L, 509258994083628758572689596862891861911425149976331505344772603877996278044763085765018284L, 19239260838083241802870625048898248928261591440656956380834127638791856333738874805279196736936601340211884654705L, 3004847544758299318296131665098217394658394271088677L, 2824013958708217496949108842204627863351483584213105055713355443608434179147167638850631497148354861262450698398640649957698287711157987941198059272443549256092745939956815893948864162794607720272630166381670440305819940L, 44601491726940814481359507253803482111148064L, 770737503641255426192946422290379096416686600236957729L, 1491969709229359926573986531109065083969769542645157142082258766608787005640347577094313L, 822752278660604482757527885140628917406976092605741304159797293L, 7237005577332262213973186564687183582826639828405953565284288034876104310828L, 3375684064392896303451101874854752750662455564276738523740645729286302830438735246481684056391671692298798536909789995798224957838666236688365255341477L, 661055968790248598951915308032771039828404682964281219284648795274405791236311524231150800653381727227195522310888512684068L, 7689318533965939854286185783566945937558547230229054720662427072873523511329L, 19239260838083241802870625048898248928261591440656956380834127825864065912094487782102155845975369930907232895008L, 19239260838083515209211222925388795491039981143327625527012989290346587961027591594367604113096322836315064893477L, 1412006979354108748474554421102313931675676955925788762341700965431346915180599249952936960497614998485448932749141998289061648432939195473813283781249050385477612018927921103458984606609675074281431536202932867664904236L, 21948213338255469908121030541472602673184L, 107840609420881270665330324360719941481540531778947411232787719127073L, 107839786668602559178668238775819553537527611608502853817761608467493L, 650304801444618521114536951021600L, 169230328010303641331690318856389386196071598838855992136870091590247882556495704709654399461950448413168131835845926332268576L, 661055968790248598951915308032771039828404682964281219284649618026684451839332601715743406936572536419342505531968225738784L, 1496577676626845918628469473729688286960211259424801L, 1491969709229359926466146744440462524802793673777187101856803985222806281068345306001449L, 994646472819573284418604282962244239379580361942773999927782159001352012024570696040744L, 2824013958708217496949108842204627863351353911851577524683401930862693830361198499905873920995229996970897865498283996578123296865878390947626553540799794689697184464818848932172786881036635386893366589878873481598927137L, 1496583388405591380208327945997925876406461387014770L, 1291124939043454294827959586001506931811325715987896067391273307527778988337814137930466501155589119496873510836028544621L, 178427739660563307060401335447093174300442664L, 178427739660887825614059762173876467760037929L, 2993155353253689177153001477636365142107690835247149L, 2993155353253689177458506431640585666923263974637600L, 1330387896122811814005820625666048032L, 2809371221627668963928216828019860176503073L, 102293456496754433437912178025862473506770063938845774671352855253004181137646079840103013137463228381940896217437204126130149185899679428595841434413L, 82631996098781074868989721086229552589602479896435685579031630632924117459263792462698176977541142502276249353505395905833L, 1291124939043454294827959586001505937164852896414611756415329678270335783630012045257077963918052413661411272201507377957L, 11090678776483259438313656736572334813745748301503295943456763075404513665394664716264486489273664208310950881168681888690136355112L, 44362715105933037753254626946289339254982993206013065202727673289833940924890009968639771713000456096217820229472770852461986119716L, 1427247713976203962356410897414694594120513519L, 11692191526388254837566470295698824293491996819489L, 11692013098647223836210383062483305509124485808161L, 347336385366046515694487271528365L, 429049853758163107186368799942587076079339706258956588087153966199097940932062732617586443688085350148605822255641330814420684346364777673262717509246325289L, 49398755520190492229097307298705660480189949388132397L, 4171850176856263914464418925665903787328476129167673448032563281733764090771394319055944549416L, 12047288691449074972472858903050911784L, 44362715105933037753254626946289339259154843382869329117192092322918382214146819522839183842694650299503998150867414845313782583337L, 1496577676626845961464918479261337480814195058016288L, 11972621591420719624395208132715859045874839000383520L, 1329717308960126498006389980148727840L, 8749002899132047697490008908470485672037261060688719719394170600488848164027313655010280678242255009L, 169231619135242684785985146815977473626848530205504745637011438945915348293931911455175496903585739450927436167148121895927849L, 994646472819573284310765319045920340815625570600230409146995267621225112884667189233965L, 2085924839766513752338888384931203236916754530447115559755622759235505711847518737876045779757L, 210624583337114373395880678637222873549306036646774381933811662880L, 1291124939043454294827959586002015693482172927722821023430304752968542648536726355983678141518486340740916622703926644784L, 19239260838083241802870625546221485366996255905578877966884877763571340362114835122641411782066726505357159375020L, 9850501549098619803069760025035903451269934817616361666987073351073122455973034947442578034582170122775449958023208L, 661055978640750148050535111102531064864308134270401064787883220666960851597643541596915266224356176619988285271037948330025L, 411376139330313202551842305363241908962888762778219535982530303L, 429049853758163107186368800289170787844441582945519199188281231999785391278560262527192665743047085554557082606696674008968744876392689376368380497086105517L, 4052261297735344686047273304385899561535592023674254954382337121329669467835736968107850111059006785103150449702485836970845979987150159481871992014481919944137291426258140246957L, 327053976961866708758361306497056L, 497323236409786642155382248146820840100456150797349047175520124003307684590349378585640L, 29642774844752946028434172162224104410458895517811927879668876609057439538155560L, 11090679437539238079063804787107445916277323419451957012177834532316857200749537135481999728327779740477765509043380162990902505769L, 11090678776483269288815205835192411289846371213897264140632131219665581911796372742662513339455646146557787908215202181383180714284L, 1291124939043454294827959586002015196158936525173184445381141572399611272593567081975784117344239658049576411405071568937L, 273406341107135484630220484984700964707143922234762290599162934244079030195881831555124668750561321L, 497323236409786642155382248247254467878335056117368901783132269738357983619864872026404L, 822852712289865785646332809827911517700321113269639431812940068L, 497323236409786642155592872730158003860915493966326172668972275599218320076165968760864L, 10634475538771422210907552426108846636L, 661055968790248598951915308032771040325727919374067861440031866173506825943599129743256449131521864647018883670435672565037L, 6393341031047152089869511126616404594173128996177860916959553453312761321102879990007209651352692159956581467267580002269120363029003856175199552805L, 2135987035924795420179473164311391038416351560169941152441318474838891643650568083113043019038967L, 93035356709837681990313447409664580397266094167977209039267155281763984261585833285254654546266650621210217706289136901464737931776962733L, 994646472819573284310765319045920343808780923837586696467576418090659240052466203099168L, 9850501549098619803069760025035903451277172706617436942976548494530260697331558200485171096013007420910280546910505L, 1291134789545003393447762655761530973068304166350312796520833193124305862138482340621777104273451294018755754946047149229L, 661055978640750148050535111102531064864308134241453042586393958479670663027561948357553922395633555190253681545708151968045L, 11090679437539228228562255688487642846517297388902032886484704718529382850168558103839528086900690787253839190075762967164782055465L, 7687697232696013035490465480201479025983241823794691621558168976140934720122093398610509570877289287501665056000317703892034984919406811867434952833786405270010451090284175347319626589563449084634543853854041920719671252642351088934164317880250265366474391584L, 1291124939043454294828232992342104310978635868979643614468246971270074961774644811913209834595681393273011696060810860461L, 169230328010303641331690319129795726793948089385426007532150305146191371771475608788231909316512213292978331317777377825259771L, 9869740809936703044872630650084801700198196409057229247951244593085310326768019009343440827702354818367777850134560L, 129672361527531029953512745740355179310169991909666022805221235967730714817339876326472984114607430282861744771439085649136827355216671507261628698465793582402346916975617587804269L, 6393341031047152089869511788963498323465182242921404078059733513606162578334354791747606378849072385992270641620782397242243859159676731456742186413L, 6393341031047152090216094838381506451620430769195746379889108087734738392999190045423823983430956038082315221176967749746659195709761949791270141985L, 4351082437154956072465106588077822995084026820419845514849846380137705972230603121617839021626518842494438922042787831473444495914685192086443301299007164164443990231636060581463692312885L, 4351082437154956072465106588077822995084026820419845514849846380137705972249842382455922263429388958284343087349527745374738624054237167892127348099145677455691180812936136897824889110578L, 60383398797144661635864873295812302254681830374669858123761255792356877789477514087010123821270747753622316951886505439951885088842443625052442742614588493070042577650477L, 102293456496754433437912347256190483829650656467247872863610186129818618595982862386491313859976689974161580147115737058143719761336970107837676770735L, 42187412251236759462558316318300192L, 994646472819573284418657761860357178587836695653803337008022803928694005350573152010873L, 102293456496754433449003026032673753099226601464356768946331258760770334938115408146420361349505517693983882588399616234743959106843913646126301586477L, 169891383979093889930642234164422157745158997605441794923266162487866828615088847546467453566010905497522348156781563319629037L, 27967679607885704301190218685229334463595448410322902860782665724913148442727445468110629165844363654273574926768831504004664310949484063607157341921576326745210557129147277658505490709665659708464960673865584962062654554254026970895287821982961965L, 4052261297735344686047273304385899561535592023674254785153300235984310851278329313641332806445666380769596920854939921532506771456371581769491582449929947144107277910003940278955L, 4489733029880535136462933621447302323204398890221600L, 11692013098647266041369388480974714973056917963812L, 429049853758163107186368799942587076079339706258956588087153966199096448962353503257659977542163661964746112261925250881915706766372180550527153908042597669L, 809157646307940135899926337371021980669050256479909050351L, 497323236409786642155382248146820840100456373826577774233458328825860656085226813521952L, 509258994083621521567219261889013142834030080081351518663456743891020443714396905192226923L, 169230328010303641331690318856389386196568922075265778779025684462978040510981248709627551820994082088512755764606012098281505L, 344801006822671798482119181336610L, 11692057721917063650024671689097564648897187107108L, 11692057700138285347927631152988414502720137527346L, 19239260838083515209211222925388795491039981143328448279291652886523018699308048538153976797373316024209297506341L, 18687756769780511615554238896948393266762663965792394932149126986753343263573661027275739087145334412673543418007245554286458446667920612051876982735882581709699406398354363317352347684223643680808L, 169230328010303641331690319129795726794942735887881118655636473606874153985528137147368224870684760986745130119275477885124897L, 169230328020154142880788938659459146221107502319768701799239610733004743849259081519506737240222013687059494159006708806582561L, 1291124939043454294827959586001505937164852896415495180211822351885170537794532763701738830812992700848083580072395408685L, 6393341031047152089869511787672373384421727948093168949730593779040680702407747115420103786213527498542921108245614214383792991023462031160500752929L, 169231619135242684785985147089381728809144248321936707588864342705192373963239423005297530416257679163271344580423002700251425L, 497323236409786642155382248146820843105303698343240227559061011578653127325973847185569L, 7729075046034516689390703781863974688597854659412869997314470502903038284579120849072387533163845155924927232063004354354741849335184623905923604577816183367160036992876577L, 29642774844753788526767520622710843333731821493349214718604694271593907229786157L, 28948022309329048855892798632390837330619200615514572700146618586790183502124L, 273406340598373813812644287898920538619166401729091416135782749310870381033863050102172664760767524L, 4501425087602535982206366521116609909445933589491557L, 44601491727285695369112108804456230075105312L, 19239260838083241802870626043544721747834875859261239343078416405435769991625018031190995596827552151586451629089L, 497323236409786752583535244131457218534392082176634267989742762672147308251063805248677L, 102293456496754433437912178027153598445813518233673734257354362184815506860870981592665512575288043110213167271927611943206555306006327590760001182501L, 7237005577542886797310302444708520043467305266106258895771175820553953962145L, 7237005578174760547321644056626516868271084856084651493477050936907033935913L, 509258994083621521677539363650993560912706833218250965301601277317677514799966463267111072L, 6393341031047152089869511126616404594173128996178134323300151329803307912829292002216729484482768799834639278727427289964552167492454772054019473697L, 169230328010303641331690318890565178770806160157176791748432561813196213826704826398478587951041544911406984030542407326699624L, 106688230926077668385277628651540124754316133157054530566340124988224595805082113144342915213944868651886878569494931847134220836335650651222516741709923931319647487551931034634670713488232679554341662119714253746596933173843566071054997323945L, 1291124939043454294827959586001506931811325715987896175282893369685960658941352916415232110973510119160695832087878109224L, 4489733074482025493448654099238850059739427284582432L, 11090678776483259438313656736572334813745748301503266300682801746254155152558690115608299955845392581325160911053426132743065637033L, 6393341031047152089869511126616404594173128996177860916959553453312761321102879990006386899074034550090678830405220231284439119309660429615735963681L, 429049853758163107186368799942587076079339706258956588087153966199096448962353503258543402970174104163615023718232443273029883835394929196873585351665111341L, 1329575411554391160501142907601420328L, 497323236409786642155382248146820844590189180677882813848173932319433684426319737856032L, 273406340597876490546563230702659094544955433417566055469636545258660300182607338232053478632063269L, 1491969709229359926573987353861343753563948692986740914285426636880884889448872258715044L, 1291124939043454294827959586001505937164852896414611756415329678270326804163818474273840764078770563748023919937204204836L, 223029230098655867975437966765228609524924708L, 313528531882069915964662425689704934689422834087799421518938595239444503444259215719322365633509271356463210615038581037888280966434941830671982119455330829510308529493942138067741376250889917435602494752L, 7237005577542886797310350323502159006569830487832094920255167538141637255341L, 211447335615776484686826294681819601235545781643536970930729910565L, 429049853758163107186368799942756306407350009900288278406283761925890894374975331814828705685848450568343756910411129013508722967366577728090749208749629565L, 6393341031047152089869511126616404594173128996177860916959554447959234140676164408611492613596983931447638448250721407963672288687914036206345257000L, 7237005577332262213973235950106501332663705749315635497839835064521890398240L, 429049853758163107186368799942587076079339706258956588087461548332269060014218386383348393045843699137304867194048214114201298344539293070432684206136631329L, 19239260838083241802870625048898248928261591440656956380834175540969699897386556082340027171810937395205566570601L, 497323236409786642155593695482436616573450740964152256906996983378491430385929163505956L, 169230328010303641331690318856389386196071598868498767865370299992463364302289651521770801696731313921674250622274644099404781L, 29650012733969491075929793922401102519098038506034431262479738994353537007943713L, 273406340597876490546591726412013053663671035840373726787946071322943744651255961123932241140514861L, 129672361527531029953512745740348785969138944757576153124864291552832900356653379848397185877473484118097910479043090928600940682456171513275012099923789046355198183773421957742629L, 108050411251939676556911441161745224854025153571720085333717165998112L, 11090679437539228228562255688487918388844931186302661873232823007921824875825906649330110996681657982306214799409218818835665850413L, 1412006979354108748474554421102313931675676955925788762341700965431346915180599249952936960497615660832542662041195245032329267205994220037432758761641625750067278599235154144176218806907546637365881879428011096288198688L, 397444631628981487398138749046400654145762820381874332451597321734669043887712482900704872660133498355324859058465554740779924491293392484209738051669536455257862040972760500917686885990564216056180974305613012183450113395710677942377L, 994646472819573284310975120876978796082578005781516177203149349774447468416303209578536L, 7237005577542886797310303929594228173156396471861984011494542644359784497184L, 661055968790248598951915308032771039828404682964281219284648795274405840623374719112552351123314554738072747021116702920737L, 1291124939043454294827959586002015196158936517936178867837432022810637573440036708074971062037761333270401026045866882105L, 429049853758163107186368799942587076079339706258956588087153966199096448964250640847724166087160696704463373836427055443754468352518210038182399052406786089L, 19239260838083241802870625048900146094799677938532647776023928820980783298221994363727420302088205330060352882733L, 10890407159730145429559704418882989719585L, 210624583337115881665704197709819115367811624989792384380379551149L, 994646472819573284310765319045920342300511055706131344495048751257410940069871996513581L, 1491969709229359926466146744440462532285681878505448453517898364347403765848704289768237L, 6393341031047152089869511126616404594173128996178134323300151329803337526656114447308903898400631034474246667296859918549574280722068476838617417065L, 273406341107632807896265809466031750096927604873095385686330910862858864337493066765500897542406637L, 6393341031047152089869511127907529533216583291006093909301658261614633599869165867697491438046130471299006851229097283736467116975238579036661350953L, 129672361527531029953512745740348785969138944757576153124865582677771943810948207534576846786528804897229408858247714406281567941783200343565417644751649091075233219491530367718697L, 273406340598373813782979802037543277622321409727595340585818212236822896243013823801459517132767529L, 11090678776483259438313656736572334813745748798826502710468560478051357961380506364767404689391367931159094519552004096362776576297L, 108050411251939675060333764556678789876414504534374571045769454747689L, 19239260838083241802870625048898248935498597017990041347085974991928316065254843067213716825589619210302830313513L, 19239260838083241802870625048898248964446729755470440683057773983722362767735138482272719279290761863980510826537L, 11090678776483259438313656736572608220086346177993813095044486500604866310955152830880620117202378862464031208786583843666634884137L, 19239260838083241802870625546221485338048233703878991196257529922763612237463144243656247730922062034578558292237L, 1491969709460944105049040993875159938858917091146080719188677508456222719489821708518536L, 994646502462348129063921972063429666788497132685382572255756446060670703516941791477793L, 631873750011392518942849972400101125491728940077522610983438778408L, 6393341031047152090216094838381506451620430769195746379889108087734738392999189938426535648176856036647306915595128073493498446836301812597334442029L, 60383398797144661635864873295812302254670739526663046854019300803929986871680722231254518149405318780794949539373048149667873239988460255856075699791450336875580870295657L, 842498333348457680655776807289012095478072520693677352641318486048L, 108050411251939675060333586150717118392340898581151267000787221024813L, 210624583337117366551189330846594416722197298344319335898372833321L, 6393341031047152089869511127907529533216583291005820502961060882447323446877418320618872269746550729645784695011734316343097440420122796667066585257L, 497323236409786642155592872730157954485544178379113906077375982698463522035556344792101L, 107839786668602610074001257187182737633664460140344718276518140837925L, 178427751624587636983667647856952604902424608L, 273406340597876490546562778389702670669146178863148132408281355898769330038459430630441994997671209L, 11090678776483259438313656736572334813745749296149739120255202741694641943478134378991274846915616547896990508407757039301663854625L, 9850501549098619805205747060956813533693904546095242830445670622675102734564749781905646539676524007386776175575072L, 11090679437539228228562255688487642846516788129907949264963137607317905088965408101867079526763146588149188675100696441781972762656L, 21779403005463402230873115517081803751456L, 9850501549098619803069760025035903451269934817618258110989386042521591899911794881451628563723266019661112146526632L, 7914572847139345089936080672628710081124203171238778877250017794972711203409019749450124833959777439667125485632516458859243681097816060497033308507972508912474899619804479532L, 19239260838083241802871134805215568988517823017000980311425092728492091688418458807706591763039438613095079612712L, 661055968790248598951915310168758076246638001798037589918912206879823902950439791106021765509948599167954124122029013205028L, 662347093729292053246743269754759581686479618284665559519945288411273383656144694548207911507702252291303852079143434518560L, 60383398797144661635967166752309056688108651704688909327526070867868832680527867661739406885273098691075957313897037887880945662722108487710823372245408370147462245745825L, 169231619135242684785985147089381728300382577474724971780592400446640033854220631654064397636670497631670339879491598457372781L, 661055968790248598951915308032771039828404682971519108393985929851436384741892230992719424379979081606181295355854716796961L, 108472483170892562913568659119209124542541142065091491972547533733929L, 51082405406395681092612450508862916880073352626770085L, 822752278711673734470781635864173489827875699614396456924479520L, 7237005577333084966251850159219603406849489273342371645721290608814810857513L, 994646472819573284311606994626990137694495645816164842334640195131756561805995894505504L, 7237005577332262213973186563043183797164891776347747689413655294033206575137L, 11692191504610141956960755762366278695365009604649L, 509258994083621521567111422102344540264375368284637295461852669013281380873610090712367393L, 994646472819573284310765319045920340815625392199713463387790602533459902984151009788013L, 210624583337117378243202429483184080422378752871147970700205817897L, 7914572847139345089936080672628710081124203171238778877250017794972711203409019749450124833959777439667125485632516458859243692790007565107299391359323029328858815261424877609L, 41703169489835827688268473469370912L, 1491969709229359926466621472505249692745955203980393307935699733091605469975997860951085L, 273406340597876490546562778389702671491898457522254575809133658111249074914485922245689988860215840L, 497323236409786642263222034815423448666187718259037311966650237392422989268813420889129L, 28948132737271420257192005811287032095659458567342599986958782313203688489772L, 2085924839766513752338888384931203236916703635113918742440197340956903125137294333427850084652L, 2135987545179904195659318118033920245381416995338341430142581346430284872257300570216016229629997L, 102293456496754433437912178025862483357271613037465851147453987424392292234656582447035046489313935861942762834561026127155635545029825777447142625832L, 994646472819573284310764496293641728091397956441316738134538695850347452050005685895201L, 178405962917819128803962902640175427697115173L, 11090848006811269741954988426891191203131944373102105156674055192550075479105061992711973631152461629336514839969708874146461188136L, 11090678776483259438313656736572334813745749296149739120255202634065479858212641683233398495165647298440025424677810106894398455840L, 11090678776483259438313656736572608220086346177993812863460308025129154377401368645139675040268162268129433065361981115005464674337L, 19239260838083241802871134307892362221506025614354136015439298982166883247465866440890766236934352309647762782125L, 169230328010322880592528402098192257330379491201077498272912808524079016732568002899437750877111885398861232089742589451777965L, 661055968790248598951915308032771039828404682964281219284648795274405794241158890605266724997536342344761732495514794661928L, 2135987035920910082395021706169552114602704522368344827647180599810664633063957195199856064987168L, 509756317320031309092690547364266863010487740131466174042009734962242913207375362538537256L, 509756317349674083054019750378925533314580183986469468426462327981711268415112633610076201L, 44601491726616296121111512017026325647327520L, 822852712301838407237775306192895997134502718410919769532923940L, 44601575467981317872504463573525198114848812L, 11692013120426624729707640900647085393578421780524L, 102293456496754433437912178025862473506770063938845774671352855253004181144883085417434452599157691485700394646214598647960785933234502479254318088224L, 108686797527801585527781689152478878100943192935023635588312408706316972108760810160597492515741050523776972006350655671080174867289010844996003891236L, 29642774844753999151350857746075397195255108373473016840253160047772033677393964L, 19239260838083241802870625048898248957209613749986005236726875387541688329874509232786696767539185352331066278189L, 1291124939043454294827993761794080671726171216761910469249163321542681517452739771758620288730909065091194135527186891052L, 178427741031143432266512103208423088632561832L, 460688772561223309599799143187044542348256984914116263229517370635452168260760357920669766257921847304541093413665686450166271656930926305302833377095927929292703149L, 4489733074482025493447406173467295583971411090866208L, 19645787055579185052383213L, 2993155397855179573887193827268740218132847693332512L, 273406340597876490546562778389810511278567060082941513380801266857609359583545392951465279784419437L, 273406340597876490546562778389810511278567060093405865104090531710409348303216461717083576026661677L, 107840609420881219793381150953096467800123054218160300419933096509485L, 273406340597876490546562778389702881293729515976036642402397119808701423409818809831482784331005992L, 210624583337115881665525802638595860132295785399834515432599584813L, 9850501549098619803069760025035903451269934817616361666987073351061430442879833570729104632247091619123288433426473L, 1427247862847467860081591848306371930638252013L, 42307602176405487794500696806191236650679280191656537211456299006635798694569924024653753462646830545856973679154868792300787L, 994646472819573284310764496293641681697489978246041725464831944223712874119393564393197L, 60383398797144661635967166752309056688108651704688909327526070867868832372945734488631031784009134382812926062485577434663912841611094585212828670452718267710236699263021L, 1291124939043454294827959586001505937164852925362634173584987955044292849717082971871706137151089099518723047591632375844L, 211447335615776484686784491672319110171205904409284844503299653924L, 210624583337114385088027559976153452992583402441759228126686806057L, 211447335615779477842134946880597560900723825547468233501701767213L, 210624583337118863129044341864148834442769025412170198413610778925L, 661055968790248598951915308032771039828404712607056947461127212900742745120858322035545268097028322650774716937091741777953L, 11090678776483259438313656736572334813745749296149739120255202633222981524864185697919743999200058498256003900107009038024266416161L, 1291124958282715132911474795212730354523357616814519473729486314348397082816564277655836444901958208776579941890758737961L, 2993155397876959016951684423963271604283484788162604L, 1491969709229359926573986531109065080988329083030188550947838013207024052140189781206249L, 19239260838083241802870625048898248928261591440656956782568640200117280273824361154938667527253124709036585517088L, 3004847544758308663455672285317419948119242037919776L, 497323236409786642263222034815423399279124211167205683544223614588663333245214993809576L, 497323236409786642155382248146820840100456150819127160829392627294849372861396201177248L, 11090848006811269761194249264974433006002569422000354084935646634049530193287692022417517614966812891072232168938669220411619278888L, 169230328010303641331690318858525373231992508921258250848617397216231234494173883980645690801958290502975449159725738564976681L, 1329231818819407925103942804655767584L, 2135987035920910082395021761383522888927214821834699846569208186953310758584540138440364460212516L, 822752278660603021255890554238197471705705262096974701384040740L, 8749002899132047697490008908470485461412677723764844293509600493369742486135129878939954008843861759L, 7729075046034516689390703781863974688597854659412869997314470502903038284579120849072387533163845155925035071849672956915417095072159547018342531667432526843406927752288169L, 275542327633797400628957800095872222783748883384019899336288793368510259677563853197494268600123424L, 2135987035920910082395021706169552114602704522368344783045701459973507019228308104436230126174249L, 822752280193098561943395229038382272448556030863997418739466532L, 52380218860345523548591399994560360005330377200238625L, 883423532389192164854505013012794183977078608834291631581704200225751072L, 210624583337115869973512682213301031482134607526540846043304165417L, 1496577855054585619732510259117062596065223535886373L, 16462354665902743786178273353974208283602497705804068L, 2135987035920910082395021706169552114602704570258830479706207381504119135161487846799410641699105L, 24500373114067288637642894829407544509728L, 4489733208286496724890757548193193688937737214361768L]

# for index, x in enumerate(D):
    # D[index] = to_binary(x)

# Initialise sample space
# T  = 2 ** A

# Dict for values U_x
U = {}
u0 = 0

def total_probability(T_c, C, u0, U):
    """ Assert and print the total probability of the model """
    total_prob = 0.0
    for T in T_c:
        p = model(T, C, u0, U)
        total_prob += p
    # assert abs(total_prob - 1.0) < 0.001, "Total probability was: %f " % total_prob
    print 'total prob: ', total_prob

def to_index_list(val):
    l = []
    while val != 0:
        index = len(bin(val)) - 3
        singleton = 2 ** index
        val = val ^ singleton
        l.append(index)
    l.sort()
    return l

def contains(a, b):
    """ True if a contains b """
    return a & b == b

def is_in_sumamry(y, C):
    """
    :param y: Itemset to look for
    :param C: Summary
    :return: Ture if y is in C
    """
    for x in C:
        if y == x:
            return True
    return False

def union_of_itemsets(itemsets):
    """Union of items in itemsets"""
    result = 0
    for c in itemsets:
        result = c | result
    return result

@memoise
def singletons_of_itemset(itemset):
    timer_start('singletons_of_itemset')
    singletons = []
    val = itemset
    pos = 0
    while val != 0:
        if val & 1 == 1:
            singletons.append(2 ** pos)
        val = val >> 1
        pos += 1
    timer_stop('singletons_of_itemset')
    return singletons

def singletons_of_itemsets(itemsets):
    timer_start('singletons_of_itemsets')
    singletons = set()
    for itemset in itemsets:
        val = itemset
        pos = 0
        while val != 0:
            if val & 1 == 1:
                singletons.add(2 ** pos)
            val = val >> 1
            pos += 1
    timer_stop('singletons_of_itemsets')
    return singletons

def p(T, y, model):
    res = 1.0
    for x in model.C:
        assert not (x in I), "Singletons are not in summary calling p()"
        if contains(T.union_of_itemsets, x):
            res = res * model.U[x]

    return model.u0 * res * T.block_weight

def old_model(t, C, u0, U):
    res = 1.0
    for x in C:
        if contains(t, x):
            res = res * U[x]
    return u0 * res

def closure(model, y):
    """ Closure, delmaenger af itemsets i T_c som er
     en delmaengde af y, hvis itemsets i closure
     maengden ikke er i itemsets for en given blok,
     skal blokken ignoreres """
    closure = set()
    for itemset in model.C:
        if itemset & y == itemset:
            closure.add(itemset)
    return closure



def query(y, model):
    cls = closure(model, y)
    T_c = compute_block_weights(model, y, cls)

    timer_start('Compute p')

    estimate = 0.0
    for T in T_c[:-1]:
        estimate += p(T, y, model)

    # Include the empty block
    # for the empty itemset
    if y == 0:
        estimate += p(T_c[-1], y, model)

    timer_stop('Compute p')

    return estimate

# Memoise: The function will cache previous results with the argument
# this assumes that D does not change between cached results.
@memoise
def fr(x):
    p = 0.0
    for xi in D:
        if contains(xi, x):
            p += 1
    p = p / float(len(D))

    assert p <= 1.0

    return p

def h(x, y):
    """
    Heurestic for scoring an itemset
    :param x:
    :param y:
    :return:
    """
    # x == 0 and y == 1
    if x < float_precision and abs(1.0 - y) < float_precision:
        return 0.0

    if y < float_precision:
        y = 0.000000000001

    # x == y
    if abs(x - y) < float_precision:
        return 0.0

    # y >= 1
    if abs(1.0 - y) < float_precision or y > 1.0:
        y = 0.9999999999

    # x == 0
    if x < float_precision:
        try:
            return -log(1.0 - y, 2)
        except Exception, e:
            print e
            print 'y: ', y
            print 'x: ', x
            exit()

    # x == 1.0
    if abs(1.0 - x) < float_precision:
        try:
            return -log(y, 2)
        except Exception, e:
            print e
            print 'y: ', y
            print 'x: ', x
            exit()


    return x * log(x / y, 2) + (1.0 - x) * log((1.0 - x) / ( 1.0 - y), 2)


branches_pruned = 0
min_sup_pruned = 0
query_cache = {}
explored = []

def cached_itemset_stats(X, model):

    estimate = 0.0

    if X in query_cache:
        estimate = query_cache[X]
    else:
        estimate = query(X, model)
        query_cache[X] = estimate

    return estimate

def total_weight(I, U):
    tw = 1
    for i in I:
        tw*= (1 + U[i])
    return tw


def find_best_itemset(Y, model):
    global query_cache
    global branches_pruned
    global min_sup_pruned
    global explored
    global Z

    query_cache = {}
    branches_pruned = 0
    min_sup_pruned = 0

    timer_start('Find best itemset')
    Z = find_best_itemset_rec(0, I.copy(), [(0,0)], model, m=m, s=s)
    timer_stop('Find best itemset')

    # print 'branches pruned: ', branches_pruned
    # print 'min sup pruned: ', min_sup_pruned

    # Edge cases where we only find singletons not exactly described by the model
    # We search the top 10 Zs to see if there was a non singleton itemset
    for z in Z:
        if not (z in I) and z != 0:
            return z
    return Z[0]

def find_best_itemset_rec(X, Y, Z, model, s, m, X_length=0):

    global branches_pruned
    global min_sup_pruned
    global explored
    """
    :param X: itemset
    :param Y: remaining itemsets
    :param Z: currently best itemset
    :param s: min support
    :param m: max itemset size
    :param X_length: number of items in X. No pretty, but since X is an int,
                     this is the fastest way to know its length
    :return: Best itemset Z
    """

    fr_X = fr(X)
    if fr_X < s:
        min_sup_pruned += 1
        return Z

    p_X = cached_itemset_stats(X, model)
    fr_Z = fr(Z[-1][0])
    p_Z = cached_itemset_stats(Z[-1][0], model)

    h_X = h(fr_X, p_X)
    h_Z = h(fr_Z, p_Z)
    if h_X > h_Z or len(Z) < 10:
        Z.append((X, h_X))
        # Sort by descending  heuristic
        Z.sort(lambda x, y: x[1] < y[1] and 1 or -1)
        if 10 < len(Z):
            Z.pop()

    XY = union_of_itemsets([X, union_of_itemsets(Y)])
    fr_XY = fr(XY)
    p_XY = cached_itemset_stats(XY, model)

    b = max(h(fr_X, p_XY), h(fr_XY, p_X))

    if Z[0][0] == 0 or b > Z[-1][1]:
        if m is None or X_length < m:
            while 0 < len(Y):
                y = Y.pop()
                Z = find_best_itemset_rec(union_of_itemsets([X, y]), Y.copy(), Z, model, s, m, X_length + 1)
        else:
            branches_pruned += 1
    else:
        branches_pruned += 1

    return Z

def find_best_itemset_iter(X, I, Z, model, s, m, X_length=0):
    global branches_pruned
    global min_sup_pruned
    global explored
    """
    :param X: itemset
    :param Y: remaining itemsets
    :param Z: currently best itemset
    :param s: min support
    :param m: max itemset size
    :param X_length: number of items in X. No pretty, but since X is an int,
                     this is the fastest way to know its length
    :return: Best itemset Z
    """

    stack = []
    stack.append((X, union_of_itemsets(I), X_length))
    d = set()
    while 0 < len(stack):
        X, Y, X_length = stack.pop()

        if not (X, Y) in d:

            d.add((X, Y))

            if m is None or X_length < m:

                # Initially all I
                Ys_copy = Y

                # If not bounded, add all Xy to the stach
                for y in I:

                    if X & y == 0 and Ys_copy & y == y:
                        Xy = X | y
                        fr_X = fr(Xy)
                        if fr_X < s:
                            min_sup_pruned += 1
                            continue
                        Ys_copy = Ys_copy ^ y

                        p_Xy = cached_itemset_stats(Xy, model)

                        fr_Z = fr(Z[0][0])
                        p_Z = cached_itemset_stats(Z[0][0], model)

                        h_X = h(fr_X, p_Xy)
                        h_Z = h(fr_Z, p_Z)
                        if h_X > h_Z or len(Z) < 10:
                            Z.append((Xy, h_X))
                            # Sort by descending  heuristic
                            Z.sort(lambda x, y: x[1] < y[1] and 1 or -1)
                            if 10 < len(Z):
                                Z.pop()

                        XY = Xy | Ys_copy
                        fr_XY = fr(XY)

                        p_XY = cached_itemset_stats(XY, model)

                        b = max(h(fr_X, p_XY), h(fr_XY, p_Xy))

                        if Z[0][0] == 0 or b > h_Z:
                            stack.append((Xy, Ys_copy, X_length + 1))
                        else:
                            branches_pruned += 1

            else:
                branches_pruned += 1

    return Z

# @memoise_set
block_cache = {}
def compute_blocks(model, y=None):
    """Compute the set of blocks that C infer
        return: Topologically sorted blocks T_C
    """

    timer_start('Compute blocks')

    T_c = list()
    T_unions = set()
    C = model.C
    if not (y is None) and y != 0:
        C = C + [y]

    # iterate the combination sizes in reverse
    a = range(len(C)+1)[::-1]
    for i in a:
        choose = i
        for comb in combinations(C, choose):
            union = union_of_itemsets(comb)

            if not (y is None) and union & y != y and union != 0:
                continue

            if not union in T_unions:
                T_unions.add(union)
                T = Block()
                T.union_of_itemsets = union
                T.singletons = singletons_of_itemsets(comb)
                T.itemsets = set(comb)
                T_c.append(T)

    timer_stop('Compute blocks')
    return T_c


def compute_block_sizes(T_c):
    for T in T_c:
        T.cummulative_block_size = 2 ** (A - len(to_chars(T.union_of_itemsets)))
    for i, Ti in enumerate(T_c):
        Ti.block_size = Ti.cummulative_block_size
        for Tj in T_c[:i]:
            if Ti < Tj:
                Ti.block_size = Ti.block_size - Tj.block_size
    return T_c

def compute_block_weights(model, y, closure):

    T_c = model.T_c
    U = model.U
    blocks = []

    total_weight = 1
    for i in I:
        total_weight *= (1 + U[i])

    timer_start('Cummulative weight')
    for T in T_c:

        for c in closure:
            if not (c in T.itemsets):
                continue

        blocks.append(T)

        T.cummulative_block_weight = total_weight

        # Remove singletons from y already covered by the block
        mask = y & T.union_of_itemsets
        ys = mask ^ y
        for i in singletons_of_itemset(ys):
            T.cummulative_block_weight *= U[i] * (1 / (1 + U[i]))

        for i in T.singletons:
            T.cummulative_block_weight *= U[i] * (1 / (1 + U[i]))
    timer_stop('Cummulative weight')

    timer_start('Block weight')
    for i, Ti in enumerate(blocks):
        Ti.block_weight = Ti.cummulative_block_weight
        for Tj in blocks[:i]:
            if Ti < Tj:
                Ti.block_weight = Ti.block_weight - Tj.block_weight

    if not (blocks[-1].union_of_itemsets == 0):
        # empty block
        T = Block()
        T.block_weight = total_weight
        T.union_of_itemsets = 0
        T.singletons = singletons_of_itemsets([0])
        T.itemsets = set()

        for i, Ti in enumerate(T_c):
            T.block_weight = T.block_weight - Ti.block_weight

        timer_stop('Block weight')

    return blocks + [T]

def iterative_scaling(models):

    # Initialize U and i0
    model.u0 = 2 ** -len(I)
    _C = I.union(model.C)
    for c in _C:
        model.U[c] = 1.0

    # TODO: only time the code if cmd line arg was given
    timer_start('Iterative scaling')

    # TODO: iterate until converged
    iterations = 0
    epsilon = 1e-5

    while iterations < 100:

        max_error = 0

        for x in _C:

            estimate = query(x, model)

            # if fr(x) == 0 or p == 0:
            #     assert False, 'itemset %d has frequency=%f and p=%f. It should not be added to the summary' % (x, fr(x), p)
            #     exit()

            fr_x = fr(x)
            if  abs(1 - fr_x) < float_precision:
                print 'fr_x was 1'
                fr_x = 0.9999999999
            if  abs(1 - estimate) < float_precision:
                print 'estimate was 1'
                p = 0.9999999999


            model.U[x] = model.U[x] * (fr_x / estimate) * ((1 - estimate) / (1 - fr_x))

            model.u0 = model.u0 * (1 - fr_x) / (1 - estimate)



            max_error = max(max_error, 1 - min(fr_x, estimate) / max(fr_x, estimate))

        iterations += 1

        if max_error < epsilon:
            break

    # print 'Iterative scaling converged in %d iterations, with biggest diff: %f' % (iterations, max_error)

    # TODO: only time the code if cmd line arg was given
    timer_stop('Iterative scaling')



def MTV():
    """ """
    global model

    T_c = compute_blocks(model)
    model.T_c = T_c
    # Initialize the model
    iterative_scaling(model)
    # print 'u0: ', model.u0
    # for ux in model.U:
    #     print ux
    model.BIC_scrores['iterative_scaling'] = score(model)

    # Add itemsets until we have k
    while len(model.C) < k:

        X, heurestic = find_best_itemset(0, model)
        assert not (X in I), 'X was a singleton! These should not be possible from the heurestic'

        if X == 0:
            print 'Best itemset found was the empty set (0). This probably ' \
                  'means the heurestic could not find any itemset ' \
                  'not already predicted by the model. Exiting MTV'
            break

        # Add X to summary
        model.C.append(X)
        model.heurestics[X] = heurestic

        T_c = compute_blocks(model)
        model.T_c = T_c

        # Update model
        iterative_scaling(model)

        # Compute score
        cur_score = score(model)
        model.BIC_scrores[X] = cur_score


def score(model):
    try:
        _C = I.union(model.C)
        U = model.U
        u0 = model.u0

        return -1 * ((len(D)) * (log(u0, 2) + sum([fr(x) * log(U[x], 2) for x in _C]))) + 0.5 * len(_C) * log(len(D))

    except Exception, e:
        print 'Exception in score function'
        print 'Summary: ', model.C
        b = 'YES'
        if u0 < 0:
            b = 'NO'
        print 'u0 %f above 0: %s' % (u0, b)
        print 'U: ', U
        exit()

# TODO move this data cleaning elsewhere
tmp = []
for i in D:
    if i != 0:
        tmp.append(i)
D = tmp


def singletons(D):
    """
    Finds all singletons present in a dataset D and adds them to a set I.
    All rows in D are or'ed together to create a bit mask of all attributes.
    These are then all read as the 1 bit in the mask being shifted right
    :param I: Set singletons are added to
    :param D: Dataset where singletons will be taken from
    :return:
    """
    global I

    # Mask all bits observed in D
    mask = 0
    for d in D:
        mask = mask | d

    # Create set of singletons for all 1 bits
    I = singletons_of_itemsets([mask])


def print_help(s, k, z):
    print '-h print this help message'
    print '-m Maximum number of items per itemset, default=inf'
    print '-s Minimum itemset support, default: s=%f' % s
    print '-k Mine top k itemsets, default is %d' % k
    print '-v verbose'
    print '-z Suggest best top z itemsets, will slow down computation, default %d' %z

def parse_argv(argv):

    k = 10
    m = None
    z = 1
    s = 0.25


    try:
        # Cmd line arguments.
        # Arguments followed by ':' expect a value
        opts, args = getopt.getopt(argv, "hm:s:k:vz:")
    except getopt.GetoptError:
       print 'Unknown arguments'
       print_help(s, k, z)
       sys.exit(2)
    for opt, arg in opts:
        if opt == '-h':
            print_help(s, k, z)
            sys.exit()

        elif opt in ("-m"):
            m = args['-m']

        elif opt in ("-k"):
            k = args['-k']

        elif opt in ("-s"):
            s = args['-s']

        elif opt in ("-z"):
            s = args['-z']

        return k, m, s, z

def main(argv):

    k, m, s, z = parse_argv(argv)

    I = set()
    singletons(D)
    print '%d items in %d transactions' % (len(I), len(D))

    MTV()

    start = time()

    print '\nModel predictions:'
    for c in model.C:
        print 'query %s with fr %f query %f uX: %f' % (to_index_list(c), fr(c), query(c, model), model.U[c])
    print ''
    print 'k=%d, m=%d, s=%0.2f' % (k, m, s)
    print '\nMTV run time: ', time() - start
    print '\nSummary: '
    print 'Heuristic \t BIC score \t Itemsets'
    print '0.000000 \t %f \t Singletons ' % model.BIC_scrores['iterative_scaling']
    for x in model.C:
        print '%f \t %f \t %s' % (model.heurestics[x], model.BIC_scrores[x], to_index_list(x))

    print ''
    timer_print_timings()

    # Write a .dat file that can be used with the Mampey MTV implementation
    with open('data_2.dat', 'w') as fd:
        for itemset in D:
            fd.write(' '.join([str(x) for x in to_index_list(itemset)]) + '\n')

    print 'final Z: ', [(to_index_list(x[0]), x[1]) for x in Z]

if __name__ == "__main__":
       main(sys.argv[1:])